// Generated by psc-bundle 0.7.4.1
var PS = { };
(function(exports) {
  /* global exports */
  "use strict";

  // module Control.Monad.Eff

  exports.returnE = function (a) {
    return function () {
      return a;
    };
  };

  exports.bindE = function (a) {
    return function (f) {
      return function () {
        return f(a())();
      };
    };
  };

  exports.forE = function (lo) {
    return function (hi) {
      return function (f) {
        return function () {
          for (var i = lo; i < hi; i++) {
            f(i)();
          }
        };
      };
    };
  };

  exports.foreachE = function (as) {
    return function (f) {
      return function () {
        for (var i = 0, l = as.length; i < l; i++) {
          f(as[i])();
        }
      };
    };
  };
 
})(PS["Control.Monad.Eff"] = PS["Control.Monad.Eff"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Prelude

  //- Functor --------------------------------------------------------------------

  exports.arrayMap = function (f) {
    return function (arr) {
      var l = arr.length;
      var result = new Array(l);
      for (var i = 0; i < l; i++) {
        result[i] = f(arr[i]);
      }
      return result;
    };
  };

  //- Bind -----------------------------------------------------------------------

  exports.arrayBind = function (arr) {
    return function (f) {
      var result = [];
      for (var i = 0, l = arr.length; i < l; i++) {
        Array.prototype.push.apply(result, f(arr[i]));
      }
      return result;
    };
  };

  //- Semiring -------------------------------------------------------------------

  exports.intAdd = function (x) {
    return function (y) {
      /* jshint bitwise: false */
      return x + y | 0;
    };
  };

  exports.intMul = function (x) {
    return function (y) {
      /* jshint bitwise: false */
      return x * y | 0;
    };
  };

  exports.numAdd = function (n1) {
    return function (n2) {
      return n1 + n2;
    };
  };

  exports.numMul = function (n1) {
    return function (n2) {
      return n1 * n2;
    };
  };

  //- Ring -----------------------------------------------------------------------

  exports.intSub = function (x) {
    return function (y) {
      /* jshint bitwise: false */
      return x - y | 0;
    };
  };

  exports.numSub = function (n1) {
    return function (n2) {
      return n1 - n2;
    };
  };                                          

  //- BooleanAlgebra -------------------------------------------------------------

  exports.boolOr = function (b1) {
    return function (b2) {
      return b1 || b2;
    };
  };

  exports.boolAnd = function (b1) {
    return function (b2) {
      return b1 && b2;
    };
  };

  exports.boolNot = function (b) {
    return !b;
  };

  //- Show -----------------------------------------------------------------------

  exports.showIntImpl = function (n) {
    return n.toString();
  };
 
})(PS["Prelude"] = PS["Prelude"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Prelude"];
  var Semigroupoid = function (compose) {
      this.compose = compose;
  };
  var Category = function (__superclass_Prelude$dotSemigroupoid_0, id) {
      this["__superclass_Prelude.Semigroupoid_0"] = __superclass_Prelude$dotSemigroupoid_0;
      this.id = id;
  };
  var Functor = function (map) {
      this.map = map;
  };
  var Apply = function (__superclass_Prelude$dotFunctor_0, apply) {
      this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
      this.apply = apply;
  };
  var Applicative = function (__superclass_Prelude$dotApply_0, pure) {
      this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
      this.pure = pure;
  };
  var Bind = function (__superclass_Prelude$dotApply_0, bind) {
      this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
      this.bind = bind;
  };
  var Monad = function (__superclass_Prelude$dotApplicative_0, __superclass_Prelude$dotBind_1) {
      this["__superclass_Prelude.Applicative_0"] = __superclass_Prelude$dotApplicative_0;
      this["__superclass_Prelude.Bind_1"] = __superclass_Prelude$dotBind_1;
  };
  var Semiring = function (add, mul, one, zero) {
      this.add = add;
      this.mul = mul;
      this.one = one;
      this.zero = zero;
  };
  var Ring = function (__superclass_Prelude$dotSemiring_0, sub) {
      this["__superclass_Prelude.Semiring_0"] = __superclass_Prelude$dotSemiring_0;
      this.sub = sub;
  };
  var Eq = function (eq) {
      this.eq = eq;
  };
  var Bounded = function (bottom, top) {
      this.bottom = bottom;
      this.top = top;
  };
  var BooleanAlgebra = function (__superclass_Prelude$dotBounded_0, conj, disj, not) {
      this["__superclass_Prelude.Bounded_0"] = __superclass_Prelude$dotBounded_0;
      this.conj = conj;
      this.disj = disj;
      this.not = not;
  };
  var Show = function (show) {
      this.show = show;
  };
  var $dollar = function (f) {
      return function (x) {
          return f(x);
      };
  };
  var zero = function (dict) {
      return dict.zero;
  };                                                                           
  var unit = {};
  var top = function (dict) {
      return dict.top;
  };
  var sub = function (dict) {
      return dict.sub;
  };
  var $minus = function (__dict_Ring_0) {
      return sub(__dict_Ring_0);
  };                                                 
  var showInt = new Show($foreign.showIntImpl);
  var show = function (dict) {
      return dict.show;
  };             
  var semiringNumber = new Semiring($foreign.numAdd, $foreign.numMul, 1.0, 0.0);
  var semiringInt = new Semiring($foreign.intAdd, $foreign.intMul, 1, 0);
  var semigroupoidFn = new Semigroupoid(function (f) {
      return function (g) {
          return function (x) {
              return f(g(x));
          };
      };
  });
  var ringNumber = new Ring(function () {
      return semiringNumber;
  }, $foreign.numSub);
  var ringInt = new Ring(function () {
      return semiringInt;
  }, $foreign.intSub);
  var pure = function (dict) {
      return dict.pure;
  };
  var $$return = function (__dict_Applicative_2) {
      return pure(__dict_Applicative_2);
  };
  var otherwise = true;
  var one = function (dict) {
      return dict.one;
  };
  var not = function (dict) {
      return dict.not;
  };
  var mul = function (dict) {
      return dict.mul;
  };
  var map = function (dict) {
      return dict.map;
  };
  var $less$dollar$greater = function (__dict_Functor_5) {
      return map(__dict_Functor_5);
  };
  var id = function (dict) {
      return dict.id;
  };
  var functorArray = new Functor($foreign.arrayMap);
  var flip = function (f) {
      return function (b) {
          return function (a) {
              return f(a)(b);
          };
      };
  };                
  var eq = function (dict) {
      return dict.eq;
  };
  var $eq$eq = function (__dict_Eq_7) {
      return eq(__dict_Eq_7);
  };
  var disj = function (dict) {
      return dict.disj;
  };
  var $$const = function (a) {
      return function (_3) {
          return a;
      };
  };
  var conj = function (dict) {
      return dict.conj;
  };
  var compose = function (dict) {
      return dict.compose;
  };                                                   
  var $less$less$less = function (__dict_Semigroupoid_14) {
      return compose(__dict_Semigroupoid_14);
  };
  var $greater$greater$greater = function (__dict_Semigroupoid_15) {
      return flip(compose(__dict_Semigroupoid_15));
  };
  var categoryFn = new Category(function () {
      return semigroupoidFn;
  }, function (x) {
      return x;
  });
  var boundedBoolean = new Bounded(false, true);
  var bottom = function (dict) {
      return dict.bottom;
  };
  var booleanAlgebraBoolean = new BooleanAlgebra(function () {
      return boundedBoolean;
  }, $foreign.boolAnd, $foreign.boolOr, $foreign.boolNot);
  var $div$eq = function (__dict_Eq_9) {
      return function (x) {
          return function (y) {
              return not(booleanAlgebraBoolean)($eq$eq(__dict_Eq_9)(x)(y));
          };
      };
  };
  var bind = function (dict) {
      return dict.bind;
  }; 
  var apply = function (dict) {
      return dict.apply;
  };
  var $less$times$greater = function (__dict_Apply_25) {
      return apply(__dict_Apply_25);
  };
  var liftA1 = function (__dict_Applicative_26) {
      return function (f) {
          return function (a) {
              return $less$times$greater(__dict_Applicative_26["__superclass_Prelude.Apply_0"]())(pure(__dict_Applicative_26)(f))(a);
          };
      };
  }; 
  var append = function (dict) {
      return dict.append;
  };
  var $less$greater = function (__dict_Semigroup_28) {
      return append(__dict_Semigroup_28);
  };
  var ap = function (__dict_Monad_30) {
      return function (f) {
          return function (a) {
              return bind(__dict_Monad_30["__superclass_Prelude.Bind_1"]())(f)(function (_2) {
                  return bind(__dict_Monad_30["__superclass_Prelude.Bind_1"]())(a)(function (_1) {
                      return $$return(__dict_Monad_30["__superclass_Prelude.Applicative_0"]())(_2(_1));
                  });
              });
          };
      };
  };
  var monadArray = new Monad(function () {
      return applicativeArray;
  }, function () {
      return bindArray;
  });
  var bindArray = new Bind(function () {
      return applyArray;
  }, $foreign.arrayBind);
  var applyArray = new Apply(function () {
      return functorArray;
  }, ap(monadArray));
  var applicativeArray = new Applicative(function () {
      return applyArray;
  }, function (x) {
      return [ x ];
  });
  var add = function (dict) {
      return dict.add;
  };
  var $plus = function (__dict_Semiring_31) {
      return add(__dict_Semiring_31);
  };
  exports["Show"] = Show;
  exports["BooleanAlgebra"] = BooleanAlgebra;
  exports["Bounded"] = Bounded;
  exports["Eq"] = Eq;
  exports["Ring"] = Ring;
  exports["Semiring"] = Semiring;
  exports["Monad"] = Monad;
  exports["Bind"] = Bind;
  exports["Applicative"] = Applicative;
  exports["Apply"] = Apply;
  exports["Functor"] = Functor;
  exports["Category"] = Category;
  exports["Semigroupoid"] = Semigroupoid;
  exports["show"] = show;
  exports["not"] = not;
  exports["disj"] = disj;
  exports["conj"] = conj;
  exports["bottom"] = bottom;
  exports["top"] = top;
  exports["/="] = $div$eq;
  exports["=="] = $eq$eq;
  exports["eq"] = eq;
  exports["-"] = $minus;
  exports["sub"] = sub;
  exports["+"] = $plus;
  exports["one"] = one;
  exports["mul"] = mul;
  exports["zero"] = zero;
  exports["add"] = add;
  exports["<>"] = $less$greater;
  exports["append"] = append;
  exports["ap"] = ap;
  exports["return"] = $$return;
  exports["bind"] = bind;
  exports["liftA1"] = liftA1;
  exports["pure"] = pure;
  exports["apply"] = apply;
  exports["<$>"] = $less$dollar$greater;
  exports["map"] = map;
  exports["id"] = id;
  exports[">>>"] = $greater$greater$greater;
  exports["<<<"] = $less$less$less;
  exports["compose"] = compose;
  exports["otherwise"] = otherwise;
  exports["const"] = $$const;
  exports["flip"] = flip;
  exports["$"] = $dollar;
  exports["unit"] = unit;
  exports["semigroupoidFn"] = semigroupoidFn;
  exports["categoryFn"] = categoryFn;
  exports["functorArray"] = functorArray;
  exports["applyArray"] = applyArray;
  exports["applicativeArray"] = applicativeArray;
  exports["bindArray"] = bindArray;
  exports["monadArray"] = monadArray;
  exports["semiringInt"] = semiringInt;
  exports["semiringNumber"] = semiringNumber;
  exports["ringInt"] = ringInt;
  exports["ringNumber"] = ringNumber;
  exports["boundedBoolean"] = boundedBoolean;
  exports["booleanAlgebraBoolean"] = booleanAlgebraBoolean;
  exports["showInt"] = showInt;;
 
})(PS["Prelude"] = PS["Prelude"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Control.Monad.Eff"];
  var Prelude = PS["Prelude"];     
  var monadEff = new Prelude.Monad(function () {
      return applicativeEff;
  }, function () {
      return bindEff;
  });
  var bindEff = new Prelude.Bind(function () {
      return applyEff;
  }, $foreign.bindE);
  var applyEff = new Prelude.Apply(function () {
      return functorEff;
  }, Prelude.ap(monadEff));
  var applicativeEff = new Prelude.Applicative(function () {
      return applyEff;
  }, $foreign.returnE);
  var functorEff = new Prelude.Functor(Prelude.liftA1(applicativeEff));
  exports["functorEff"] = functorEff;
  exports["applyEff"] = applyEff;
  exports["applicativeEff"] = applicativeEff;
  exports["bindEff"] = bindEff;
  exports["monadEff"] = monadEff;
  exports["foreachE"] = $foreign.foreachE;
  exports["forE"] = $foreign.forE;;
 
})(PS["Control.Monad.Eff"] = PS["Control.Monad.Eff"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Control.Monad.Eff.Random

  exports.random = Math.random;
 
})(PS["Control.Monad.Eff.Random"] = PS["Control.Monad.Eff.Random"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Data.Int

  exports.fromNumberImpl = function (just) {
    return function (nothing) {
      return function (n) {
        /* jshint bitwise: false */
        return (n | 0) === n ? just(n) : nothing;
      };
    };
  };

  exports.toNumber = function (n) {
    return n;
  };
 
})(PS["Data.Int"] = PS["Data.Int"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Prelude = PS["Prelude"];
  var mempty = function (dict) {
      return dict.mempty;
  };
  exports["mempty"] = mempty;;
 
})(PS["Data.Monoid"] = PS["Data.Monoid"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Prelude = PS["Prelude"];
  var Control_Alt = PS["Control.Alt"];
  var Control_Alternative = PS["Control.Alternative"];
  var Control_Extend = PS["Control.Extend"];
  var Control_MonadPlus = PS["Control.MonadPlus"];
  var Control_Plus = PS["Control.Plus"];
  var Data_Functor_Invariant = PS["Data.Functor.Invariant"];
  var Data_Monoid = PS["Data.Monoid"];     
  var Nothing = (function () {
      function Nothing() {

      };
      Nothing.value = new Nothing();
      return Nothing;
  })();
  var Just = (function () {
      function Just(value0) {
          this.value0 = value0;
      };
      Just.create = function (value0) {
          return new Just(value0);
      };
      return Just;
  })();
  var maybe = function (b) {
      return function (f) {
          return function (_154) {
              if (_154 instanceof Nothing) {
                  return b;
              };
              if (_154 instanceof Just) {
                  return f(_154.value0);
              };
              throw new Error("Failed pattern match at Data.Maybe line 26, column 1 - line 27, column 1: " + [ b.constructor.name, f.constructor.name, _154.constructor.name ]);
          };
      };
  };
  exports["Nothing"] = Nothing;
  exports["Just"] = Just;
  exports["maybe"] = maybe;;
 
})(PS["Data.Maybe"] = PS["Data.Maybe"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Data.Maybe.Unsafe

  exports.unsafeThrow = function (msg) {
    throw new Error(msg);
  };
 
})(PS["Data.Maybe.Unsafe"] = PS["Data.Maybe.Unsafe"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Data.Maybe.Unsafe"];
  var Prelude = PS["Prelude"];
  var Data_Maybe = PS["Data.Maybe"];     
  var fromJust = function (_217) {
      if (_217 instanceof Data_Maybe.Just) {
          return _217.value0;
      };
      if (_217 instanceof Data_Maybe.Nothing) {
          return $foreign.unsafeThrow("Data.Maybe.Unsafe.fromJust called on Nothing");
      };
      throw new Error("Failed pattern match at Data.Maybe.Unsafe line 10, column 1 - line 11, column 1: " + [ _217.constructor.name ]);
  };
  exports["fromJust"] = fromJust;;
 
})(PS["Data.Maybe.Unsafe"] = PS["Data.Maybe.Unsafe"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Math

  exports.abs = Math.abs;

  exports.floor = Math.floor;

  exports.max = function (n1) {
    return function (n2) {
      return Math.max(n1, n2);
    };
  };

  exports.min = function (n1) {
    return function (n2) {
      return Math.min(n1, n2);
    };
  };

  exports["%"] = function(n) {
    return function(m) {
      return n % m;
    };
  };                         
 
})(PS["Math"] = PS["Math"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Math"];
  exports["%"] = $foreign["%"];
  exports["min"] = $foreign.min;
  exports["max"] = $foreign.max;
  exports["floor"] = $foreign.floor;
  exports["abs"] = $foreign.abs;;
 
})(PS["Math"] = PS["Math"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Data.Int"];
  var Prelude = PS["Prelude"];
  var Data_Int_Bits = PS["Data.Int.Bits"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Maybe_Unsafe = PS["Data.Maybe.Unsafe"];
  var $$Math = PS["Math"];                                                                   
  var fromNumber = $foreign.fromNumberImpl(Data_Maybe.Just.create)(Data_Maybe.Nothing.value);
  exports["fromNumber"] = fromNumber;
  exports["toNumber"] = $foreign.toNumber;;
 
})(PS["Data.Int"] = PS["Data.Int"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Control.Monad.Eff.Random"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Data_Int = PS["Data.Int"];
  exports["random"] = $foreign.random;;
 
})(PS["Control.Monad.Eff.Random"] = PS["Control.Monad.Eff.Random"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Control.Monad.ST

  exports.newSTRef = function (val) {
    return function () {
      return { value: val };
    };
  };

  exports.readSTRef = function (ref) {
    return function () {
      return ref.value;
    };
  };

  exports.modifySTRef = function (ref) {
    return function (f) {
      return function () {
        /* jshint boss: true */
        return ref.value = f(ref.value);
      };
    };
  };
 
})(PS["Control.Monad.ST"] = PS["Control.Monad.ST"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Control.Monad.ST"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  exports["modifySTRef"] = $foreign.modifySTRef;
  exports["readSTRef"] = $foreign.readSTRef;
  exports["newSTRef"] = $foreign.newSTRef;;
 
})(PS["Control.Monad.ST"] = PS["Control.Monad.ST"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module DOM.Event.EventTarget

  exports.eventListener = function (fn) {
    return function (event) {
      return fn(event)();
    };
  };

  exports.addEventListener = function (type) {
    return function (listener) {
      return function (useCapture) {
        return function (target) {
          return function () {
            target.addEventListener(type, listener, useCapture);
            return {};
          };
        };
      };
    };
  };
 
})(PS["DOM.Event.EventTarget"] = PS["DOM.Event.EventTarget"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["DOM.Event.EventTarget"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_Eff_Exception = PS["Control.Monad.Eff.Exception"];
  var DOM = PS["DOM"];
  var DOM_Event_Types = PS["DOM.Event.Types"];
  exports["addEventListener"] = $foreign.addEventListener;
  exports["eventListener"] = $foreign.eventListener;;
 
})(PS["DOM.Event.EventTarget"] = PS["DOM.Event.EventTarget"] || {});
(function(exports) {
  /* global exports, window */
  "use strict";

  // module DOM.HTML

  exports.window = function () {
    return window;
  };
 
})(PS["DOM.HTML"] = PS["DOM.HTML"] || {});
(function(exports) {
  "use strict";

  // module Unsafe.Coerce

  exports.unsafeCoerce = function(x) { return x; }
 
})(PS["Unsafe.Coerce"] = PS["Unsafe.Coerce"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Unsafe.Coerce"];
  exports["unsafeCoerce"] = $foreign.unsafeCoerce;;
 
})(PS["Unsafe.Coerce"] = PS["Unsafe.Coerce"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["DOM.HTML.Types"];
  var Prelude = PS["Prelude"];
  var Data_Either = PS["Data.Either"];
  var Data_Foreign = PS["Data.Foreign"];
  var Data_Foreign_Class = PS["Data.Foreign.Class"];
  var DOM_Event_Types = PS["DOM.Event.Types"];
  var DOM_Node_Types = PS["DOM.Node.Types"];
  var Unsafe_Coerce = PS["Unsafe.Coerce"];     
  var windowToEventTarget = Unsafe_Coerce.unsafeCoerce;
  exports["windowToEventTarget"] = windowToEventTarget;;
 
})(PS["DOM.HTML.Types"] = PS["DOM.HTML.Types"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["DOM.HTML"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var DOM = PS["DOM"];
  var DOM_HTML_Types = PS["DOM.HTML.Types"];
  exports["window"] = $foreign.window;;
 
})(PS["DOM.HTML"] = PS["DOM.HTML"] || {});
(function(exports) {
  /* global exports */
  "use strict";


  // module DOM.Timer

  exports.timeout = function(time){
    return function(fn){
      return function(){
        return setTimeout(function(){
          fn();
        }, time);
      };
    };
  };

  exports.interval = function(time){
    return function(fn){
      return function(){
        return setInterval(function(){
          fn();
        }, time);
      };
    };
  };
 
})(PS["DOM.Timer"] = PS["DOM.Timer"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["DOM.Timer"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  exports["interval"] = $foreign.interval;
  exports["timeout"] = $foreign.timeout;;
 
})(PS["DOM.Timer"] = PS["DOM.Timer"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Data.Array

  //------------------------------------------------------------------------------
  // Array creation --------------------------------------------------------------
  //------------------------------------------------------------------------------

  exports.range = function (start) {
    return function (end) {
      var step = start > end ? -1 : 1;
      var result = [];
      for (var i = start, n = 0; i !== end; i += step) {
        result[n++] = i;
      }
      result[n] = i;
      return result;
    };
  };

  exports.replicate = function (n) {
    return function (v) {
      if (n < 1) return [];
      var r = new Array(n);
      for (var i = 0; i < n; i++) r[i] = v;
      return r;
    };
  };

  //------------------------------------------------------------------------------
  // Array size ------------------------------------------------------------------
  //------------------------------------------------------------------------------

  exports.length = function (xs) {
    return xs.length;
  };

  //------------------------------------------------------------------------------
  // Extending arrays ------------------------------------------------------------
  //------------------------------------------------------------------------------

  exports.cons = function (e) {
    return function (l) {
      return [e].concat(l);
    };
  };

  //------------------------------------------------------------------------------
  // Non-indexed reads -----------------------------------------------------------
  //------------------------------------------------------------------------------

  exports["uncons'"] = function (empty) {
    return function (next) {
      return function (xs) {
        return xs.length === 0 ? empty({}) : next(xs[0])(xs.slice(1));
      };
    };
  };

  //------------------------------------------------------------------------------
  // Indexed operations ----------------------------------------------------------
  //------------------------------------------------------------------------------

  exports.indexImpl = function (just) {
    return function (nothing) {
      return function (xs) {
        return function (i) {
          return i < 0 || i >= xs.length ? nothing :  just(xs[i]);
        };
      };
    };
  };

  exports.findIndexImpl = function (just) {
    return function (nothing) {
      return function (f) {
        return function (xs) {
          for (var i = 0, l = xs.length; i < l; i++) {
            if (f(xs[i])) return just(i);
          }
          return nothing;
        };
      };
    };
  };

  exports.findLastIndexImpl = function (just) {
    return function (nothing) {
      return function (f) {
        return function (xs) {
          for (var i = xs.length - 1; i >= 0; i--) {
            if (f(xs[i])) return just(i);
          }
          return nothing;
        };
      };
    };
  };

  exports._deleteAt = function (just) {
    return function (nothing) {
      return function (i) {
        return function (l) {
          if (i < 0 || i >= l.length) return nothing;
          var l1 = l.slice();
          l1.splice(i, 1);
          return just(l1);
        };
      };
    };
  };

  exports.concat = function (xss) {
    var result = [];
    for (var i = 0, l = xss.length; i < l; i++) {
      var xs = xss[i];
      for (var j = 0, m = xs.length; j < m; j++) {
        result.push(xs[j]);
      }
    }
    return result;
  };

  exports.filter = function (f) {
    return function (xs) {
      return xs.filter(f);
    };
  };

  //------------------------------------------------------------------------------
  // Subarrays -------------------------------------------------------------------
  //------------------------------------------------------------------------------

  exports.slice = function (s) {
    return function (e) {
      return function (l) {
        return l.slice(s, e);
      };
    };
  };
 
})(PS["Data.Array"] = PS["Data.Array"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Data.Foldable

  exports.foldrArray = function (f) {
    return function (init) {
      return function (xs) {
        var acc = init;
        var len = xs.length;
        for (var i = len - 1; i >= 0; i--) {
          acc = f(xs[i])(acc);
        }
        return acc;
      };
    };
  };

  exports.foldlArray = function (f) {
    return function (init) {
      return function (xs) {
        var acc = init;
        var len = xs.length;
        for (var i = 0; i < len; i++) {
          acc = f(acc)(xs[i]);
        }
        return acc;
      };
    };
  };
 
})(PS["Data.Foldable"] = PS["Data.Foldable"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Data.Foldable"];
  var Prelude = PS["Prelude"];
  var Control_Apply = PS["Control.Apply"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Maybe_First = PS["Data.Maybe.First"];
  var Data_Maybe_Last = PS["Data.Maybe.Last"];
  var Data_Monoid = PS["Data.Monoid"];
  var Data_Monoid_Additive = PS["Data.Monoid.Additive"];
  var Data_Monoid_Dual = PS["Data.Monoid.Dual"];
  var Data_Monoid_Disj = PS["Data.Monoid.Disj"];
  var Data_Monoid_Conj = PS["Data.Monoid.Conj"];
  var Data_Monoid_Multiplicative = PS["Data.Monoid.Multiplicative"];     
  var Foldable = function (foldMap, foldl, foldr) {
      this.foldMap = foldMap;
      this.foldl = foldl;
      this.foldr = foldr;
  };
  var foldr = function (dict) {
      return dict.foldr;
  };
  var foldl = function (dict) {
      return dict.foldl;
  }; 
  var foldableArray = new Foldable(function (__dict_Monoid_19) {
      return function (f) {
          return function (xs) {
              return foldr(foldableArray)(function (x) {
                  return function (acc) {
                      return Prelude["<>"](__dict_Monoid_19["__superclass_Prelude.Semigroup_0"]())(f(x))(acc);
                  };
              })(Data_Monoid.mempty(__dict_Monoid_19))(xs);
          };
      };
  }, $foreign.foldlArray, $foreign.foldrArray);
  var foldMap = function (dict) {
      return dict.foldMap;
  };
  exports["Foldable"] = Foldable;
  exports["foldMap"] = foldMap;
  exports["foldl"] = foldl;
  exports["foldr"] = foldr;
  exports["foldableArray"] = foldableArray;;
 
})(PS["Data.Foldable"] = PS["Data.Foldable"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Data.Traversable

  // jshint maxparams: 3

  exports.traverseArrayImpl = function () {
    function Cont (fn) {
      this.fn = fn;
    }

    var emptyList = {};

    var ConsCell = function (head, tail) {
      this.head = head;
      this.tail = tail;
    };

    function consList (x) {
      return function (xs) {
        return new ConsCell(x, xs);
      };
    }

    function listToArray (list) {
      var arr = [];
      while (list !== emptyList) {
        arr.push(list.head);
        list = list.tail;
      }
      return arr;
    }

    return function (apply) {
      return function (map) {
        return function (pure) {
          return function (f) {
            var buildFrom = function (x, ys) {
              return apply(map(consList)(f(x)))(ys);
            };

            var go = function (acc, currentLen, xs) {
              if (currentLen === 0) {
                return acc;
              } else {
                var last = xs[currentLen - 1];
                return new Cont(function () {
                  return go(buildFrom(last, acc), currentLen - 1, xs);
                });
              }
            };

            return function (array) {
              var result = go(pure(emptyList), array.length, array);
              while (result instanceof Cont) {
                result = result.fn();
              }

              return map(listToArray)(result);
            };
          };
        };
      };
    };
  }();
 
})(PS["Data.Traversable"] = PS["Data.Traversable"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Data.Traversable"];
  var Prelude = PS["Prelude"];
  var Data_Foldable = PS["Data.Foldable"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Maybe_First = PS["Data.Maybe.First"];
  var Data_Maybe_Last = PS["Data.Maybe.Last"];
  var Data_Monoid_Additive = PS["Data.Monoid.Additive"];
  var Data_Monoid_Dual = PS["Data.Monoid.Dual"];
  var Data_Monoid_Multiplicative = PS["Data.Monoid.Multiplicative"];
  var Data_Monoid_Disj = PS["Data.Monoid.Disj"];
  var Data_Monoid_Conj = PS["Data.Monoid.Conj"];
  var Traversable = function (__superclass_Data$dotFoldable$dotFoldable_1, __superclass_Prelude$dotFunctor_0, sequence, traverse) {
      this["__superclass_Data.Foldable.Foldable_1"] = __superclass_Data$dotFoldable$dotFoldable_1;
      this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
      this.sequence = sequence;
      this.traverse = traverse;
  };
  var traverse = function (dict) {
      return dict.traverse;
  }; 
  var traversableArray = new Traversable(function () {
      return Data_Foldable.foldableArray;
  }, function () {
      return Prelude.functorArray;
  }, function (__dict_Applicative_11) {
      return traverse(traversableArray)(__dict_Applicative_11)(Prelude.id(Prelude.categoryFn));
  }, function (__dict_Applicative_10) {
      return $foreign.traverseArrayImpl(Prelude.apply(__dict_Applicative_10["__superclass_Prelude.Apply_0"]()))(Prelude.map((__dict_Applicative_10["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]()))(Prelude.pure(__dict_Applicative_10));
  });
  var sequence = function (dict) {
      return dict.sequence;
  };
  exports["Traversable"] = Traversable;
  exports["sequence"] = sequence;
  exports["traverse"] = traverse;
  exports["traversableArray"] = traversableArray;;
 
})(PS["Data.Traversable"] = PS["Data.Traversable"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Prelude = PS["Prelude"];
  var Control_Biapplicative = PS["Control.Biapplicative"];
  var Control_Biapply = PS["Control.Biapply"];
  var Control_Comonad = PS["Control.Comonad"];
  var Control_Extend = PS["Control.Extend"];
  var Control_Lazy = PS["Control.Lazy"];
  var Data_Bifoldable = PS["Data.Bifoldable"];
  var Data_Bifunctor = PS["Data.Bifunctor"];
  var Data_Bitraversable = PS["Data.Bitraversable"];
  var Data_Foldable = PS["Data.Foldable"];
  var Data_Functor_Invariant = PS["Data.Functor.Invariant"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Maybe_First = PS["Data.Maybe.First"];
  var Data_Monoid = PS["Data.Monoid"];
  var Data_Traversable = PS["Data.Traversable"];     
  var Tuple = (function () {
      function Tuple(value0, value1) {
          this.value0 = value0;
          this.value1 = value1;
      };
      Tuple.create = function (value0) {
          return function (value1) {
              return new Tuple(value0, value1);
          };
      };
      return Tuple;
  })();
  exports["Tuple"] = Tuple;;
 
})(PS["Data.Tuple"] = PS["Data.Tuple"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Data.Array"];
  var Prelude = PS["Prelude"];
  var Control_Alt = PS["Control.Alt"];
  var Control_Alternative = PS["Control.Alternative"];
  var Control_Lazy = PS["Control.Lazy"];
  var Control_MonadPlus = PS["Control.MonadPlus"];
  var Control_Plus = PS["Control.Plus"];
  var Data_Foldable = PS["Data.Foldable"];
  var Data_Functor_Invariant = PS["Data.Functor.Invariant"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Monoid = PS["Data.Monoid"];
  var Data_Traversable = PS["Data.Traversable"];
  var Data_Tuple = PS["Data.Tuple"];
  var Data_Maybe_Unsafe = PS["Data.Maybe.Unsafe"];     
  var $colon = $foreign.cons;
  var $dot$dot = $foreign.range;
  var uncons = $foreign["uncons'"](Prelude["const"](Data_Maybe.Nothing.value))(function (x) {
      return function (xs) {
          return new Data_Maybe.Just({
              head: x, 
              tail: xs
          });
      };
  });                          
  var tail = $foreign["uncons'"](Prelude["const"](Data_Maybe.Nothing.value))(function (_287) {
      return function (xs) {
          return new Data_Maybe.Just(xs);
      };
  });
  var replicateM = function (__dict_Monad_2) {
      return function (n) {
          return function (m) {
              if (n < 1) {
                  return Prelude["return"](__dict_Monad_2["__superclass_Prelude.Applicative_0"]())([  ]);
              };
              if (Prelude.otherwise) {
                  return Data_Traversable.sequence(Data_Traversable.traversableArray)(__dict_Monad_2["__superclass_Prelude.Applicative_0"]())($foreign.replicate(n)(m));
              };
              throw new Error("Failed pattern match at Data.Array line 117, column 1 - line 118, column 1: " + [ n.constructor.name, m.constructor.name ]);
          };
      };
  };
  var $$null = function (xs) {
      return $foreign.length(xs) === 0;
  };
  var nubBy = function (eq) {
      return function (xs) {
          var _1053 = uncons(xs);
          if (_1053 instanceof Data_Maybe.Just) {
              return $colon(_1053.value0.head)(nubBy(eq)($foreign.filter(function (y) {
                  return !eq(_1053.value0.head)(y);
              })(_1053.value0.tail)));
          };
          if (_1053 instanceof Data_Maybe.Nothing) {
              return [  ];
          };
          throw new Error("Failed pattern match: " + [ _1053.constructor.name ]);
      };
  };
  var nub = function (__dict_Eq_3) {
      return nubBy(Prelude.eq(__dict_Eq_3));
  };
  var index = $foreign.indexImpl(Data_Maybe.Just.create)(Data_Maybe.Nothing.value);
  var $bang$bang = index;
  var head = $foreign["uncons'"](Prelude["const"](Data_Maybe.Nothing.value))(function (x) {
      return function (_286) {
          return new Data_Maybe.Just(x);
      };
  });
  var findLastIndex = $foreign.findLastIndexImpl(Data_Maybe.Just.create)(Data_Maybe.Nothing.value);
  var findIndex = $foreign.findIndexImpl(Data_Maybe.Just.create)(Data_Maybe.Nothing.value);
  var deleteAt = $foreign._deleteAt(Data_Maybe.Just.create)(Data_Maybe.Nothing.value);
  var deleteBy = function (eq) {
      return function (x) {
          return function (_292) {
              if (_292.length === 0) {
                  return [  ];
              };
              return Data_Maybe.maybe(_292)(function (i) {
                  return Data_Maybe_Unsafe.fromJust(deleteAt(i)(_292));
              })(findIndex(eq(x))(_292));
          };
      };
  };
  var $$delete = function (__dict_Eq_17) {
      return deleteBy(Prelude.eq(__dict_Eq_17));
  };
  var $bslash$bslash = function (__dict_Eq_18) {
      return function (xs) {
          return function (ys) {
              if ($$null(xs)) {
                  return [  ];
              };
              if (Prelude.otherwise) {
                  return $foreign["uncons'"](Prelude["const"](xs))(function (y) {
                      return function (ys_2) {
                          return $bslash$bslash(__dict_Eq_18)($$delete(__dict_Eq_18)(y)(xs))(ys_2);
                      };
                  })(ys);
              };
              throw new Error("Failed pattern match: " + [ xs.constructor.name, ys.constructor.name ]);
          };
      };
  };
  exports["\\\\"] = $bslash$bslash;
  exports["deleteBy"] = deleteBy;
  exports["nubBy"] = nubBy;
  exports["nub"] = nub;
  exports["deleteAt"] = deleteAt;
  exports["findLastIndex"] = findLastIndex;
  exports["findIndex"] = findIndex;
  exports["index"] = index;
  exports["!!"] = $bang$bang;
  exports["uncons"] = uncons;
  exports["tail"] = tail;
  exports["head"] = head;
  exports["replicateM"] = replicateM;
  exports[".."] = $dot$dot;
  exports["filter"] = $foreign.filter;
  exports["concat"] = $foreign.concat;
  exports["cons"] = $foreign.cons;
  exports["length"] = $foreign.length;;
 
})(PS["Data.Array"] = PS["Data.Array"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Prelude = PS["Prelude"];
  var Data_Bifoldable = PS["Data.Bifoldable"];
  var Data_Foldable = PS["Data.Foldable"];
  var Data_Functor_Contravariant = PS["Data.Functor.Contravariant"];
  var Data_Functor_Invariant = PS["Data.Functor.Invariant"];
  var Data_Monoid = PS["Data.Monoid"];
  var Data_Traversable = PS["Data.Traversable"];     
  var Const = function (x) {
      return x;
  };
  var getConst = function (_22) {
      return _22;
  };
  var functorConst = new Prelude.Functor(function (_32) {
      return function (_33) {
          return _33;
      };
  });
  exports["Const"] = Const;
  exports["getConst"] = getConst;
  exports["functorConst"] = functorConst;;
 
})(PS["Data.Const"] = PS["Data.Const"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Data.Date

  exports.nowEpochMilliseconds = function () {
    return Date.now();
  };
 
})(PS["Data.Date"] = PS["Data.Date"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Prelude = PS["Prelude"];
  var TimeValue = function (fromHours, fromMilliseconds, fromMinutes, fromSeconds, toHours, toMilliseconds, toMinutes, toSeconds) {
      this.fromHours = fromHours;
      this.fromMilliseconds = fromMilliseconds;
      this.fromMinutes = fromMinutes;
      this.fromSeconds = fromSeconds;
      this.toHours = toHours;
      this.toMilliseconds = toMilliseconds;
      this.toMinutes = toMinutes;
      this.toSeconds = toSeconds;
  };
  var toSeconds = function (dict) {
      return dict.toSeconds;
  };
  var toMinutes = function (dict) {
      return dict.toMinutes;
  };
  var toMilliseconds = function (dict) {
      return dict.toMilliseconds;
  };
  var toHours = function (dict) {
      return dict.toHours;
  }; 
  var timeValueMilliseconds = new TimeValue(function (_104) {
      return _104 * 3600000.0;
  }, function (n) {
      return n;
  }, function (_105) {
      return _105 * 60000.0;
  }, function (_106) {
      return _106 * 1000.0;
  }, function (_101) {
      return _101 / 3600000.0;
  }, function (n) {
      return n;
  }, function (_102) {
      return _102 / 60000.0;
  }, function (_103) {
      return _103 / 1000.0;
  });          
  var semiringMilliseconds = new Prelude.Semiring(function (_72) {
      return function (_73) {
          return _72 + _73;
      };
  }, function (_74) {
      return function (_75) {
          return _74 * _75;
      };
  }, 1.0, 0.0);
  var ringMilliseconds = new Prelude.Ring(function () {
      return semiringMilliseconds;
  }, function (_76) {
      return function (_77) {
          return _76 - _77;
      };
  });
  var fromSeconds = function (dict) {
      return dict.fromSeconds;
  };
  var fromMinutes = function (dict) {
      return dict.fromMinutes;
  };
  var fromMilliseconds = function (dict) {
      return dict.fromMilliseconds;
  };
  var fromHours = function (dict) {
      return dict.fromHours;
  };
  exports["TimeValue"] = TimeValue;
  exports["fromMilliseconds"] = fromMilliseconds;
  exports["fromSeconds"] = fromSeconds;
  exports["fromMinutes"] = fromMinutes;
  exports["fromHours"] = fromHours;
  exports["toMilliseconds"] = toMilliseconds;
  exports["toSeconds"] = toSeconds;
  exports["toMinutes"] = toMinutes;
  exports["toHours"] = toHours;
  exports["semiringMilliseconds"] = semiringMilliseconds;
  exports["ringMilliseconds"] = ringMilliseconds;
  exports["timeValueMilliseconds"] = timeValueMilliseconds;;
 
})(PS["Data.Time"] = PS["Data.Time"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Data.Date"];
  var Global = PS["Global"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Data_Enum = PS["Data.Enum"];
  var Data_Function = PS["Data.Function"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Time = PS["Data.Time"];
  exports["nowEpochMilliseconds"] = $foreign.nowEpochMilliseconds;;
 
})(PS["Data.Date"] = PS["Data.Date"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Prelude = PS["Prelude"];
  var Control_Comonad = PS["Control.Comonad"];
  var Control_Extend = PS["Control.Extend"];
  var Data_Foldable = PS["Data.Foldable"];
  var Data_Functor_Invariant = PS["Data.Functor.Invariant"];
  var Data_Monoid = PS["Data.Monoid"];
  var Data_Traversable = PS["Data.Traversable"];     
  var Identity = function (x) {
      return x;
  };
  var runIdentity = function (_55) {
      return _55;
  };
  var functorIdentity = new Prelude.Functor(function (f) {
      return function (_78) {
          return f(_78);
      };
  });
  exports["Identity"] = Identity;
  exports["runIdentity"] = runIdentity;
  exports["functorIdentity"] = functorIdentity;;
 
})(PS["Data.Identity"] = PS["Data.Identity"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Prelude = PS["Prelude"];     
  var Profunctor = function (dimap) {
      this.dimap = dimap;
  };
  var profunctorFn = new Profunctor(function (a2b) {
      return function (c2d) {
          return function (b2c) {
              return Prelude[">>>"](Prelude.semigroupoidFn)(a2b)(Prelude[">>>"](Prelude.semigroupoidFn)(b2c)(c2d));
          };
      };
  });
  var dimap = function (dict) {
      return dict.dimap;
  };
  var rmap = function (__dict_Profunctor_1) {
      return function (b2c) {
          return dimap(__dict_Profunctor_1)(Prelude.id(Prelude.categoryFn))(b2c);
      };
  };
  exports["Profunctor"] = Profunctor;
  exports["rmap"] = rmap;
  exports["dimap"] = dimap;
  exports["profunctorFn"] = profunctorFn;;
 
})(PS["Data.Profunctor"] = PS["Data.Profunctor"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Types = PS["Optic.Types"];
  var Prelude = PS["Prelude"];
  var lens = function (s2a) {
      return function (s2b2t) {
          return function (__dict_Functor_1) {
              return function (a2fb) {
                  return function (s) {
                      return Prelude["<$>"](__dict_Functor_1)(s2b2t(s))(a2fb(s2a(s)));
                  };
              };
          };
      };
  };
  exports["lens"] = lens;;
 
})(PS["Optic.Lens"] = PS["Optic.Lens"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Data_Const = PS["Data.Const"];
  var Data_Functor_Contravariant = PS["Data.Functor.Contravariant"];
  var Data_Profunctor = PS["Data.Profunctor"];
  var Optic_Types = PS["Optic.Types"];
  var Prelude = PS["Prelude"];
  var $up$dot = function (s) {
      return function (asa) {
          return Data_Const.getConst(asa(Data_Const.Const)(s));
      };
  };
  exports["^."] = $up$dot;;
 
})(PS["Optic.Getter"] = PS["Optic.Getter"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Data_Functor_Contravariant = PS["Data.Functor.Contravariant"];
  var Data_Identity = PS["Data.Identity"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Profunctor = PS["Data.Profunctor"];
  var Optic_Internal_Setter = PS["Optic.Internal.Setter"];
  var Optic_Types = PS["Optic.Types"];
  var Prelude = PS["Prelude"];
  var set = function (stab) {
      return function (b) {
          return function (_340) {
              return Data_Identity.runIdentity(stab(function (_341) {
                  return Data_Identity.Identity(Prelude["const"](b)(_341));
              })(_340));
          };
      };
  };
  var $dot$tilde = set;
  var over = function (__dict_Profunctor_3) {
      return function (pstab) {
          return function (pab) {
              return function (_342) {
                  return Data_Identity.runIdentity(pstab(Data_Profunctor.rmap(__dict_Profunctor_3)(Data_Identity.Identity)(pab))(_342));
              };
          };
      };
  };
  var $percent$tilde = function (__dict_Profunctor_4) {
      return over(__dict_Profunctor_4);
  };
  var $plus$tilde = function (__dict_Semiring_8) {
      return function (staa) {
          return function (a) {
              return over(Data_Profunctor.profunctorFn)(staa)(Prelude.flip(Prelude["+"](__dict_Semiring_8))(a));
          };
      };
  };
  var $minus$tilde = function (__dict_Ring_9) {
      return function (staa) {
          return function (a) {
              return over(Data_Profunctor.profunctorFn)(staa)(Prelude.flip(Prelude["-"](__dict_Ring_9))(a));
          };
      };
  };
  exports["set"] = set;
  exports["over"] = over;
  exports["-~"] = $minus$tilde;
  exports["+~"] = $plus$tilde;
  exports[".~"] = $dot$tilde;
  exports["%~"] = $percent$tilde;;
 
})(PS["Optic.Setter"] = PS["Optic.Setter"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Getter = PS["Optic.Getter"];
  var Optic_Lens = PS["Optic.Lens"];
  var Optic_Prism = PS["Optic.Prism"];
  var Optic_Setter = PS["Optic.Setter"];
  var Optic_Types = PS["Optic.Types"];
  var Prelude = PS["Prelude"];     
  var $dot$dot = function (__dict_Semigroupoid_0) {
      return Prelude["<<<"](__dict_Semigroupoid_0);
  };
  exports[".."] = $dot$dot;;
 
})(PS["Optic.Core"] = PS["Optic.Core"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Optic_Getter = PS["Optic.Getter"];
  var Prelude = PS["Prelude"];
  var Optic_Core = PS["Optic.Core"];
  var Data_Const = PS["Data.Const"];     
  var Player = (function () {
      function Player() {

      };
      Player.value = new Player();
      return Player;
  })();
  var Invader = (function () {
      function Invader() {

      };
      Invader.value = new Invader();
      return Invader;
  })();
  var Mystery = (function () {
      function Mystery() {

      };
      Mystery.value = new Mystery();
      return Mystery;
  })();
  var Boss = (function () {
      function Boss() {

      };
      Boss.value = new Boss();
      return Boss;
  })();
  var Bullet = (function () {
      function Bullet(value0) {
          this.value0 = value0;
      };
      Bullet.create = function (value0) {
          return new Bullet(value0);
      };
      return Bullet;
  })();
  var y = Optic_Lens.lens(function (_56) {
      return _56.value0.y;
  })(function (_57) {
      return function (y$prime) {
          return new Bullet((function () {
              var _116 = {};
              for (var _117 in _57.value0) {
                  if (_57.value0.hasOwnProperty(_117)) {
                      _116[_117] = _57.value0[_117];
                  };
              };
              _116.y = y$prime;
              return _116;
          })());
      };
  });
  var x = Optic_Lens.lens(function (_54) {
      return _54.value0.x;
  })(function (_55) {
      return function (x$prime) {
          return new Bullet((function () {
              var _122 = {};
              for (var _123 in _55.value0) {
                  if (_55.value0.hasOwnProperty(_123)) {
                      _122[_123] = _55.value0[_123];
                  };
              };
              _122.x = x$prime;
              return _122;
          })());
      };
  });
  var makeBullet = function (t) {
      return function (x_1) {
          return function (y_1) {
              return new Bullet({
                  type: t, 
                  x: x_1, 
                  y: y_1
              });
          };
      };
  };
  var makeInvaderBullet = makeBullet(Invader.value);
  var makeMysteryBullet = makeBullet(Mystery.value);
  var makePlayerBullet = makeBullet(Player.value);
  var eqType = new Prelude.Eq(function (_58) {
      return function (_59) {
          if (_58 instanceof Player && _59 instanceof Player) {
              return true;
          };
          if (_58 instanceof Invader && _59 instanceof Invader) {
              return true;
          };
          if (_58 instanceof Boss && _59 instanceof Boss) {
              return true;
          };
          return false;
      };
  });
  var bulletType = Optic_Lens.lens(function (_52) {
      return _52.value0.type;
  })(function (_53) {
      return function (type$prime) {
          return new Bullet((function () {
              var _130 = {};
              for (var _131 in _53.value0) {
                  if (_53.value0.hasOwnProperty(_131)) {
                      _130[_131] = _53.value0[_131];
                  };
              };
              _130.type = type$prime;
              return _130;
          })());
      };
  });
  var eqBullet = new Prelude.Eq(function (b1) {
      return function (b2) {
          return Prelude["=="](eqType)(Optic_Getter["^."](b1)(bulletType(Data_Const.functorConst)))(Optic_Getter["^."](b2)(bulletType(Data_Const.functorConst))) && (Optic_Getter["^."](b1)(x(Data_Const.functorConst)) === Optic_Getter["^."](b2)(x(Data_Const.functorConst)) && Optic_Getter["^."](b1)(y(Data_Const.functorConst)) === Optic_Getter["^."](b2)(y(Data_Const.functorConst)));
      };
  });
  exports["Bullet"] = Bullet;
  exports["Player"] = Player;
  exports["Invader"] = Invader;
  exports["Mystery"] = Mystery;
  exports["Boss"] = Boss;
  exports["y"] = y;
  exports["x"] = x;
  exports["bulletType"] = bulletType;
  exports["makeMysteryBullet"] = makeMysteryBullet;
  exports["makeInvaderBullet"] = makeInvaderBullet;
  exports["makePlayerBullet"] = makePlayerBullet;
  exports["makeBullet"] = makeBullet;
  exports["eqType"] = eqType;
  exports["eqBullet"] = eqBullet;;
 
})(PS["Entities.Bullet"] = PS["Entities.Bullet"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Optic_Getter = PS["Optic.Getter"];
  var Prelude = PS["Prelude"];
  var Optic_Core = PS["Optic.Core"];
  var Data_Const = PS["Data.Const"];     
  var Alive = (function () {
      function Alive() {

      };
      Alive.value = new Alive();
      return Alive;
  })();
  var Shot = (function () {
      function Shot() {

      };
      Shot.value = new Shot();
      return Shot;
  })();
  var Dead = (function () {
      function Dead() {

      };
      Dead.value = new Dead();
      return Dead;
  })();
  var Invader = (function () {
      function Invader(value0) {
          this.value0 = value0;
      };
      Invader.create = function (value0) {
          return new Invader(value0);
      };
      return Invader;
  })();
  var y = Optic_Lens.lens(function (_33) {
      return _33.value0.y;
  })(function (_34) {
      return function (y$prime) {
          return new Invader((function () {
              var _95 = {};
              for (var _96 in _34.value0) {
                  if (_34.value0.hasOwnProperty(_96)) {
                      _95[_96] = _34.value0[_96];
                  };
              };
              _95.y = y$prime;
              return _95;
          })());
      };
  });
  var x = Optic_Lens.lens(function (_31) {
      return _31.value0.x;
  })(function (_32) {
      return function (x$prime) {
          return new Invader((function () {
              var _101 = {};
              for (var _102 in _32.value0) {
                  if (_32.value0.hasOwnProperty(_102)) {
                      _101[_102] = _32.value0[_102];
                  };
              };
              _101.x = x$prime;
              return _101;
          })());
      };
  });
  var status = Optic_Lens.lens(function (_37) {
      return _37.value0.status;
  })(function (_38) {
      return function (status$prime) {
          return new Invader((function () {
              var _107 = {};
              for (var _108 in _38.value0) {
                  if (_38.value0.hasOwnProperty(_108)) {
                      _107[_108] = _38.value0[_108];
                  };
              };
              _107.status = status$prime;
              return _107;
          })());
      };
  });
  var makeInvader = function (x_1) {
      return function (y_1) {
          return function (idx_1) {
              return new Invader({
                  x: x_1, 
                  y: y_1, 
                  idx: idx_1, 
                  status: Alive.value
              });
          };
      };
  };
  var idx = Optic_Lens.lens(function (_35) {
      return _35.value0.idx;
  })(function (_36) {
      return function (idx$prime) {
          return new Invader((function () {
              var _113 = {};
              for (var _114 in _36.value0) {
                  if (_36.value0.hasOwnProperty(_114)) {
                      _113[_114] = _36.value0[_114];
                  };
              };
              _113.idx = idx$prime;
              return _113;
          })());
      };
  });
  var eqStatus = new Prelude.Eq(function (_39) {
      return function (_40) {
          if (_39 instanceof Alive && _40 instanceof Alive) {
              return true;
          };
          if (_39 instanceof Shot && _40 instanceof Shot) {
              return true;
          };
          if (_39 instanceof Dead && _40 instanceof Dead) {
              return true;
          };
          return false;
      };
  });
  var eqInvader = new Prelude.Eq(function (i1) {
      return function (i2) {
          return Optic_Getter["^."](i1)(idx(Data_Const.functorConst)) === Optic_Getter["^."](i2)(idx(Data_Const.functorConst));
      };
  });
  exports["Invader"] = Invader;
  exports["Alive"] = Alive;
  exports["Shot"] = Shot;
  exports["Dead"] = Dead;
  exports["makeInvader"] = makeInvader;
  exports["status"] = status;
  exports["idx"] = idx;
  exports["y"] = y;
  exports["x"] = x;
  exports["eqStatus"] = eqStatus;
  exports["eqInvader"] = eqInvader;;
 
})(PS["Entities.Invader"] = PS["Entities.Invader"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Prelude = PS["Prelude"];
  var Optic_Core = PS["Optic.Core"];     
  var Alive = (function () {
      function Alive() {

      };
      Alive.value = new Alive();
      return Alive;
  })();
  var Shot = (function () {
      function Shot() {

      };
      Shot.value = new Shot();
      return Shot;
  })();
  var Dead = (function () {
      function Dead() {

      };
      Dead.value = new Dead();
      return Dead;
  })();
  var MysteryShip = (function () {
      function MysteryShip(value0) {
          this.value0 = value0;
      };
      MysteryShip.create = function (value0) {
          return new MysteryShip(value0);
      };
      return MysteryShip;
  })();
  var y = Optic_Lens.lens(function (_56) {
      return _56.value0.y;
  })(function (_57) {
      return function (y$prime) {
          return new MysteryShip((function () {
              var _129 = {};
              for (var _130 in _57.value0) {
                  if (_57.value0.hasOwnProperty(_130)) {
                      _129[_130] = _57.value0[_130];
                  };
              };
              _129.y = y$prime;
              return _129;
          })());
      };
  });
  var x = Optic_Lens.lens(function (_54) {
      return _54.value0.x;
  })(function (_55) {
      return function (x$prime) {
          return new MysteryShip((function () {
              var _135 = {};
              for (var _136 in _55.value0) {
                  if (_55.value0.hasOwnProperty(_136)) {
                      _135[_136] = _55.value0[_136];
                  };
              };
              _135.x = x$prime;
              return _135;
          })());
      };
  });
  var status = Optic_Lens.lens(function (_58) {
      return _58.value0.status;
  })(function (_59) {
      return function (status$prime) {
          return new MysteryShip((function () {
              var _141 = {};
              for (var _142 in _59.value0) {
                  if (_59.value0.hasOwnProperty(_142)) {
                      _141[_142] = _59.value0[_142];
                  };
              };
              _141.status = status$prime;
              return _141;
          })());
      };
  });
  var makeMysteryShip = function (x_1) {
      return function (y_1) {
          return new MysteryShip({
              x: x_1, 
              y: y_1, 
              status: Alive.value
          });
      };
  };
  var eqStatus = new Prelude.Eq(function (_60) {
      return function (_61) {
          if (_60 instanceof Alive && _61 instanceof Alive) {
              return true;
          };
          if (_60 instanceof Shot && _61 instanceof Shot) {
              return true;
          };
          if (_60 instanceof Dead && _61 instanceof Dead) {
              return true;
          };
          return false;
      };
  });
  exports["MysteryShip"] = MysteryShip;
  exports["Alive"] = Alive;
  exports["Shot"] = Shot;
  exports["Dead"] = Dead;
  exports["makeMysteryShip"] = makeMysteryShip;
  exports["status"] = status;
  exports["y"] = y;
  exports["x"] = x;
  exports["eqStatus"] = eqStatus;;
 
})(PS["Entities.MysteryShip"] = PS["Entities.MysteryShip"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Prelude = PS["Prelude"];
  var Data_Array = PS["Data.Array"];
  var Data_Int = PS["Data.Int"];
  var Data_Maybe = PS["Data.Maybe"];
  var Optic_Core = PS["Optic.Core"];
  var Entities_Boss = PS["Entities.Boss"];
  var Entities_Invader = PS["Entities.Invader"];
  var Entities_MysteryShip = PS["Entities.MysteryShip"];     
  var Left = (function () {
      function Left() {

      };
      Left.value = new Left();
      return Left;
  })();
  var Right = (function () {
      function Right() {

      };
      Right.value = new Right();
      return Right;
  })();
  var Patrol = (function () {
      function Patrol(value0) {
          this.value0 = value0;
      };
      Patrol.create = function (value0) {
          return new Patrol(value0);
      };
      return Patrol;
  })();
  var mysteryShip = Optic_Lens.lens(function (_68) {
      if (_68 instanceof Patrol) {
          return _68.value0.mysteryShip;
      };
      throw new Error("Failed pattern match at Entities.Enemies line 36, column 1 - line 39, column 1: " + [ _68.constructor.name ]);
  })(function (_69) {
      if (_69 instanceof Patrol) {
          return function (mysteryShip$prime) {
              return new Patrol((function () {
                  var _149 = {};
                  for (var _150 in _69.value0) {
                      if (_69.value0.hasOwnProperty(_150)) {
                          _149[_150] = _69.value0[_150];
                      };
                  };
                  _149.mysteryShip = mysteryShip$prime;
                  return _149;
              })());
          };
      };
      throw new Error("Failed pattern match at Entities.Enemies line 36, column 1 - line 39, column 1: " + [ _69.constructor.name ]);
  });
  var makeRegularLevel = (function () {
      var makeInvaders = Prelude.bind(Prelude.bindArray)(Data_Array[".."](0)(7))(function (_2) {
          return Prelude.bind(Prelude.bindArray)(Data_Array[".."](0)(2))(function (_1) {
              return Prelude["return"](Prelude.applicativeArray)(Entities_Invader.makeInvader(50.0 + 75.0 * Data_Int.toNumber(_2))(125.0 + 75.0 * Data_Int.toNumber(_1))(_2 + (7 * _1 | 0) | 0));
          });
      });
      return new Patrol({
          invaders: makeInvaders, 
          direction: Right.value, 
          dx: 2.0, 
          mysteryShip: Data_Maybe.Nothing.value
      });
  })();                                                                      
  var invaders = Optic_Lens.lens(function (_62) {
      if (_62 instanceof Patrol) {
          return _62.value0.invaders;
      };
      throw new Error("Failed pattern match at Entities.Enemies line 30, column 1 - line 32, column 1: " + [ _62.constructor.name ]);
  })(function (_63) {
      if (_63 instanceof Patrol) {
          return function (invaders$prime) {
              return new Patrol((function () {
                  var _157 = {};
                  for (var _158 in _63.value0) {
                      if (_63.value0.hasOwnProperty(_158)) {
                          _157[_158] = _63.value0[_158];
                      };
                  };
                  _157.invaders = invaders$prime;
                  return _157;
              })());
          };
      };
      throw new Error("Failed pattern match at Entities.Enemies line 30, column 1 - line 32, column 1: " + [ _63.constructor.name ]);
  });
  var eqDirection = new Prelude.Eq(function (_70) {
      return function (_71) {
          if (_70 instanceof Left && _71 instanceof Left) {
              return true;
          };
          if (_70 instanceof Right && _71 instanceof Right) {
              return true;
          };
          return false;
      };
  });
  var dx = Optic_Lens.lens(function (_66) {
      if (_66 instanceof Patrol) {
          return _66.value0.dx;
      };
      throw new Error("Failed pattern match at Entities.Enemies line 34, column 1 - line 36, column 1: " + [ _66.constructor.name ]);
  })(function (_67) {
      if (_67 instanceof Patrol) {
          return function (dx$prime) {
              return new Patrol((function () {
                  var _165 = {};
                  for (var _166 in _67.value0) {
                      if (_67.value0.hasOwnProperty(_166)) {
                          _165[_166] = _67.value0[_166];
                      };
                  };
                  _165.dx = dx$prime;
                  return _165;
              })());
          };
      };
      throw new Error("Failed pattern match at Entities.Enemies line 34, column 1 - line 36, column 1: " + [ _67.constructor.name ]);
  });
  var direction = Optic_Lens.lens(function (_64) {
      if (_64 instanceof Patrol) {
          return _64.value0.direction;
      };
      throw new Error("Failed pattern match at Entities.Enemies line 32, column 1 - line 34, column 1: " + [ _64.constructor.name ]);
  })(function (_65) {
      if (_65 instanceof Patrol) {
          return function (direction$prime) {
              return new Patrol((function () {
                  var _171 = {};
                  for (var _172 in _65.value0) {
                      if (_65.value0.hasOwnProperty(_172)) {
                          _171[_172] = _65.value0[_172];
                      };
                  };
                  _171.direction = direction$prime;
                  return _171;
              })());
          };
      };
      throw new Error("Failed pattern match at Entities.Enemies line 32, column 1 - line 34, column 1: " + [ _65.constructor.name ]);
  });
  exports["Patrol"] = Patrol;
  exports["Left"] = Left;
  exports["Right"] = Right;
  exports["makeRegularLevel"] = makeRegularLevel;
  exports["mysteryShip"] = mysteryShip;
  exports["dx"] = dx;
  exports["direction"] = direction;
  exports["invaders"] = invaders;
  exports["eqDirection"] = eqDirection;;
 
})(PS["Entities.Enemies"] = PS["Entities.Enemies"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Prelude = PS["Prelude"];
  var Optic_Core = PS["Optic.Core"];     
  var Handled = (function () {
      function Handled() {

      };
      Handled.value = new Handled();
      return Handled;
  })();
  var New = (function () {
      function New() {

      };
      New.value = new New();
      return New;
  })();
  var NewInvaderBullet = (function () {
      function NewInvaderBullet() {

      };
      NewInvaderBullet.value = new NewInvaderBullet();
      return NewInvaderBullet;
  })();
  var NewMysteryBullet = (function () {
      function NewMysteryBullet() {

      };
      NewMysteryBullet.value = new NewMysteryBullet();
      return NewMysteryBullet;
  })();
  var NewMysteryShip = (function () {
      function NewMysteryShip() {

      };
      NewMysteryShip.value = new NewMysteryShip();
      return NewMysteryShip;
  })();
  var GoneMysteryShip = (function () {
      function GoneMysteryShip() {

      };
      GoneMysteryShip.value = new GoneMysteryShip();
      return GoneMysteryShip;
  })();
  var InvaderShot = (function () {
      function InvaderShot() {

      };
      InvaderShot.value = new InvaderShot();
      return InvaderShot;
  })();
  var MysteryShipShot = (function () {
      function MysteryShipShot() {

      };
      MysteryShipShot.value = new MysteryShipShot();
      return MysteryShipShot;
  })();
  var PlayerShot = (function () {
      function PlayerShot() {

      };
      PlayerShot.value = new PlayerShot();
      return PlayerShot;
  })();
  var Event = (function () {
      function Event(value0, value1) {
          this.value0 = value0;
          this.value1 = value1;
      };
      Event.create = function (value0) {
          return function (value1) {
              return new Event(value0, value1);
          };
      };
      return Event;
  })();
  var status = Optic_Lens.lens(function (_55) {
      return _55.value1;
  })(function (_56) {
      return function (status$prime) {
          return new Event(_56.value0, status$prime);
      };
  });
  var eqStatus = new Prelude.Eq(function (_57) {
      return function (_58) {
          if (_57 instanceof Handled && _58 instanceof Handled) {
              return true;
          };
          if (_57 instanceof New && _58 instanceof New) {
              return true;
          };
          return false;
      };
  });
  exports["Event"] = Event;
  exports["NewInvaderBullet"] = NewInvaderBullet;
  exports["NewMysteryBullet"] = NewMysteryBullet;
  exports["NewMysteryShip"] = NewMysteryShip;
  exports["GoneMysteryShip"] = GoneMysteryShip;
  exports["InvaderShot"] = InvaderShot;
  exports["MysteryShipShot"] = MysteryShipShot;
  exports["PlayerShot"] = PlayerShot;
  exports["Handled"] = Handled;
  exports["New"] = New;
  exports["status"] = status;
  exports["eqStatus"] = eqStatus;;
 
})(PS["Entities.Event"] = PS["Entities.Event"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  exports.getCanvasElementByIdImpl = function(id, Just, Nothing) {
      return function() {
          var el = document.getElementById(id);
          if (el && el instanceof HTMLCanvasElement) {
              return Just(el);
          } else {
              return Nothing;
          }
      };
  };

  exports.getContext2D = function(c) {
      return function() {
          return c.getContext('2d');
      };
  };

  exports.setFillStyle = function(style) {
      return function(ctx) {
          return function() {
              ctx.fillStyle = style;
              return ctx;
          };
      };
  };

  exports.fillRect = function(ctx) {
      return function(r) {
          return function() {
              ctx.fillRect(r.x, r.y, r.w, r.h);
              return ctx;
          };
      };
  };

  exports.font = function(ctx) {
      return function() {
          return ctx.font;
      };
  };

  exports.setFont = function(fontspec) {
      return function(ctx) {
          return function() {
              ctx.font = fontspec;
              return ctx;
          };
      };
  };

  exports.fillText = function(ctx) {
      return function(text) {
          return function(x) {
              return function(y) {
                  return function() {
                      ctx.fillText(text, x, y);
                      return ctx;
                  };
              };
          };
      };
  };

  exports.drawImage = function(ctx) {
      return function(image_source) {
          return function(dx) {
              return function(dy) {
                  return function() {
                      ctx.drawImage(image_source, dx, dy);
                      return ctx;
                  };
              };
          };
      };
  };

 
})(PS["Graphics.Canvas"] = PS["Graphics.Canvas"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Graphics.Canvas"];
  var Prelude = PS["Prelude"];
  var Data_Function = PS["Data.Function"];
  var Data_Maybe = PS["Data.Maybe"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var getCanvasElementById = function (elId) {
      return $foreign.getCanvasElementByIdImpl(elId, Data_Maybe.Just.create, Data_Maybe.Nothing.value);
  };
  exports["getCanvasElementById"] = getCanvasElementById;
  exports["drawImage"] = $foreign.drawImage;
  exports["fillText"] = $foreign.fillText;
  exports["setFont"] = $foreign.setFont;
  exports["fillRect"] = $foreign.fillRect;
  exports["setFillStyle"] = $foreign.setFillStyle;
  exports["getContext2D"] = $foreign.getContext2D;;
 
})(PS["Graphics.Canvas"] = PS["Graphics.Canvas"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Optic_Core = PS["Optic.Core"];     
  var Alive = (function () {
      function Alive() {

      };
      Alive.value = new Alive();
      return Alive;
  })();
  var Player = (function () {
      function Player(value0) {
          this.value0 = value0;
      };
      Player.create = function (value0) {
          return new Player(value0);
      };
      return Player;
  })();
  var y = Optic_Lens.lens(function (_13) {
      return _13.value0.y;
  })(function (_14) {
      return function (y$prime) {
          return new Player((function () {
              var _32 = {};
              for (var _33 in _14.value0) {
                  if (_14.value0.hasOwnProperty(_33)) {
                      _32[_33] = _14.value0[_33];
                  };
              };
              _32.y = y$prime;
              return _32;
          })());
      };
  });
  var x = Optic_Lens.lens(function (_11) {
      return _11.value0.x;
  })(function (_12) {
      return function (x$prime) {
          return new Player((function () {
              var _38 = {};
              for (var _39 in _12.value0) {
                  if (_12.value0.hasOwnProperty(_39)) {
                      _38[_39] = _12.value0[_39];
                  };
              };
              _38.x = x$prime;
              return _38;
          })());
      };
  });
  var status = Optic_Lens.lens(function (_15) {
      return _15.value0.status;
  })(function (_16) {
      return function (status$prime) {
          return new Player((function () {
              var _44 = {};
              for (var _45 in _16.value0) {
                  if (_16.value0.hasOwnProperty(_45)) {
                      _44[_45] = _16.value0[_45];
                  };
              };
              _44.status = status$prime;
              return _44;
          })());
      };
  });
  var makePlayer = function (x_1) {
      return function (y_1) {
          return new Player({
              x: x_1, 
              y: y_1, 
              status: Alive.value
          });
      };
  };
  exports["Player"] = Player;
  exports["Alive"] = Alive;
  exports["makePlayer"] = makePlayer;
  exports["status"] = status;
  exports["y"] = y;
  exports["x"] = x;;
 
})(PS["Entities.Player"] = PS["Entities.Player"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Helpers.Audio

  exports.loadSound = function(url) {
    return function() {
      var newSound = new Audio(url);
      return newSound;
    };
  };

  exports.playSound = function(sound) {
    return function() {
      sound.load();
      sound.play();
    };
  };

  exports.stopSound = function(sound) {
    return function() {
      sound.pause();
    };
  };
 
})(PS["Helpers.Audio"] = PS["Helpers.Audio"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Helpers.Audio"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  exports["stopSound"] = $foreign.stopSound;
  exports["playSound"] = $foreign.playSound;
  exports["loadSound"] = $foreign.loadSound;;
 
})(PS["Helpers.Audio"] = PS["Helpers.Audio"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Optic_Core = PS["Optic.Core"];
  var Helpers_Audio = PS["Helpers.Audio"];     
  var Sounds = (function () {
      function Sounds(value0) {
          this.value0 = value0;
      };
      Sounds.create = function (value0) {
          return new Sounds(value0);
      };
      return Sounds;
  })();
  var playerShot = Optic_Lens.lens(function (_75) {
      return _75.value0.playerShot;
  })(function (_76) {
      return function (playerShot$prime) {
          return new Sounds((function () {
              var _141 = {};
              for (var _142 in _76.value0) {
                  if (_76.value0.hasOwnProperty(_142)) {
                      _141[_142] = _76.value0[_142];
                  };
              };
              _141.playerShot = playerShot$prime;
              return _141;
          })());
      };
  });
  var newPlayerBullet = Optic_Lens.lens(function (_63) {
      return _63.value0.newPlayerBullet;
  })(function (_64) {
      return function (newPlayerBullet$prime) {
          return new Sounds((function () {
              var _147 = {};
              for (var _148 in _64.value0) {
                  if (_64.value0.hasOwnProperty(_148)) {
                      _147[_148] = _64.value0[_148];
                  };
              };
              _147.newPlayerBullet = newPlayerBullet$prime;
              return _147;
          })());
      };
  });
  var newMysteryShip = Optic_Lens.lens(function (_67) {
      return _67.value0.newMysteryShip;
  })(function (_68) {
      return function (newMysteryShip$prime) {
          return new Sounds((function () {
              var _153 = {};
              for (var _154 in _68.value0) {
                  if (_68.value0.hasOwnProperty(_154)) {
                      _153[_154] = _68.value0[_154];
                  };
              };
              _153.newMysteryShip = newMysteryShip$prime;
              return _153;
          })());
      };
  });
  var newMysteryBullet = Optic_Lens.lens(function (_69) {
      return _69.value0.newMysteryBullet;
  })(function (_70) {
      return function (newMysteryBullet$prime) {
          return new Sounds((function () {
              var _159 = {};
              for (var _160 in _70.value0) {
                  if (_70.value0.hasOwnProperty(_160)) {
                      _159[_160] = _70.value0[_160];
                  };
              };
              _159.newMysteryBullet = newMysteryBullet$prime;
              return _159;
          })());
      };
  });
  var newInvaderBullet = Optic_Lens.lens(function (_65) {
      return _65.value0.newInvaderBullet;
  })(function (_66) {
      return function (newInvaderBullet$prime) {
          return new Sounds((function () {
              var _165 = {};
              for (var _166 in _66.value0) {
                  if (_66.value0.hasOwnProperty(_166)) {
                      _165[_166] = _66.value0[_166];
                  };
              };
              _165.newInvaderBullet = newInvaderBullet$prime;
              return _165;
          })());
      };
  });
  var mysteryShipShot = Optic_Lens.lens(function (_73) {
      return _73.value0.mysteryShipShot;
  })(function (_74) {
      return function (mysteryShipShot$prime) {
          return new Sounds((function () {
              var _171 = {};
              for (var _172 in _74.value0) {
                  if (_74.value0.hasOwnProperty(_172)) {
                      _171[_172] = _74.value0[_172];
                  };
              };
              _171.mysteryShipShot = mysteryShipShot$prime;
              return _171;
          })());
      };
  });
  var loadAllSounds = function __do() {
      var _8 = Helpers_Audio.loadSound("sounds/newPlayerBullet.wav")();
      var _7 = Helpers_Audio.loadSound("sounds/newInvaderBullet.wav")();
      var _6 = Helpers_Audio.loadSound("sounds/newMysteryShip.mp3")();
      var _5 = Helpers_Audio.loadSound("sounds/newMysteryBullet.wav")();
      var _4 = Helpers_Audio.loadSound("sounds/invaderShot.wav")();
      var _3 = Helpers_Audio.loadSound("sounds/mysteryShipShot.wav")();
      var _2 = Helpers_Audio.loadSound("sounds/playerShot.wav")();
      return Prelude["return"](Control_Monad_Eff.applicativeEff)(new Sounds({
          newPlayerBullet: _8, 
          newInvaderBullet: _7, 
          newMysteryShip: _6, 
          newMysteryBullet: _5, 
          invaderShot: _4, 
          mysteryShipShot: _3, 
          playerShot: _2
      }))();
  };
  var invaderShot = Optic_Lens.lens(function (_71) {
      return _71.value0.invaderShot;
  })(function (_72) {
      return function (invaderShot$prime) {
          return new Sounds((function () {
              var _184 = {};
              for (var _185 in _72.value0) {
                  if (_72.value0.hasOwnProperty(_185)) {
                      _184[_185] = _72.value0[_185];
                  };
              };
              _184.invaderShot = invaderShot$prime;
              return _184;
          })());
      };
  });
  exports["Sounds"] = Sounds;
  exports["loadAllSounds"] = loadAllSounds;
  exports["playerShot"] = playerShot;
  exports["mysteryShipShot"] = mysteryShipShot;
  exports["invaderShot"] = invaderShot;
  exports["newMysteryBullet"] = newMysteryBullet;
  exports["newMysteryShip"] = newMysteryShip;
  exports["newInvaderBullet"] = newInvaderBullet;
  exports["newPlayerBullet"] = newPlayerBullet;;
 
})(PS["Entities.Sounds"] = PS["Entities.Sounds"] || {});
(function(exports) {
  /* global exports */
  "use strict";

  // module Helpers.Image

  exports.makeCanvasImageSource = function(url) {
    return function() {
      var newImage = new Image();
      newImage.src = url;
      return newImage;
    };
  };

  exports.getWidth = function(img) {
    return img.width;
  }

  exports.getHeight = function(img) {
    return img.height;
  }
 
})(PS["Helpers.Image"] = PS["Helpers.Image"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var $foreign = PS["Helpers.Image"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Data_Int = PS["Data.Int"];
  var Graphics_Canvas = PS["Graphics.Canvas"];     
  var drawImageCentered = function (ctx) {
      return function (img) {
          return function (x) {
              return function (y) {
                  var w = Data_Int.toNumber($foreign.getWidth(img));
                  var h = Data_Int.toNumber($foreign.getHeight(img));
                  return Graphics_Canvas.drawImage(ctx)(img)(x - 0.5 * w)(y - 0.5 * h);
              };
          };
      };
  };
  exports["drawImageCentered"] = drawImageCentered;
  exports["makeCanvasImageSource"] = $foreign.makeCanvasImageSource;;
 
})(PS["Helpers.Image"] = PS["Helpers.Image"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Graphics_Canvas = PS["Graphics.Canvas"];
  var Optic_Core = PS["Optic.Core"];
  var Helpers_Image = PS["Helpers.Image"];     
  var Sprites = (function () {
      function Sprites(value0) {
          this.value0 = value0;
      };
      Sprites.create = function (value0) {
          return new Sprites(value0);
      };
      return Sprites;
  })();
  var shotInvader = Optic_Lens.lens(function (_75) {
      return _75.value0.shotInvader;
  })(function (_76) {
      return function (shotInvader$prime) {
          return new Sprites((function () {
              var _139 = {};
              for (var _140 in _76.value0) {
                  if (_76.value0.hasOwnProperty(_140)) {
                      _139[_140] = _76.value0[_140];
                  };
              };
              _139.shotInvader = shotInvader$prime;
              return _139;
          })());
      };
  });
  var playerBullet = Optic_Lens.lens(function (_69) {
      return _69.value0.playerBullet;
  })(function (_70) {
      return function (playerBullet$prime) {
          return new Sprites((function () {
              var _145 = {};
              for (var _146 in _70.value0) {
                  if (_70.value0.hasOwnProperty(_146)) {
                      _145[_146] = _70.value0[_146];
                  };
              };
              _145.playerBullet = playerBullet$prime;
              return _145;
          })());
      };
  });
  var player = Optic_Lens.lens(function (_67) {
      return _67.value0.player;
  })(function (_68) {
      return function (player$prime) {
          return new Sprites((function () {
              var _151 = {};
              for (var _152 in _68.value0) {
                  if (_68.value0.hasOwnProperty(_152)) {
                      _151[_152] = _68.value0[_152];
                  };
              };
              _151.player = player$prime;
              return _151;
          })());
      };
  });
  var mysteryShip = Optic_Lens.lens(function (_79) {
      return _79.value0.mysteryShip;
  })(function (_80) {
      return function (mysteryShip$prime) {
          return new Sprites((function () {
              var _157 = {};
              for (var _158 in _80.value0) {
                  if (_80.value0.hasOwnProperty(_158)) {
                      _157[_158] = _80.value0[_158];
                  };
              };
              _157.mysteryShip = mysteryShip$prime;
              return _157;
          })());
      };
  });
  var mysteryBullet = Optic_Lens.lens(function (_81) {
      return _81.value0.mysteryBullet;
  })(function (_82) {
      return function (mysteryBullet$prime) {
          return new Sprites((function () {
              var _163 = {};
              for (var _164 in _82.value0) {
                  if (_82.value0.hasOwnProperty(_164)) {
                      _163[_164] = _82.value0[_164];
                  };
              };
              _163.mysteryBullet = mysteryBullet$prime;
              return _163;
          })());
      };
  });
  var loadSprites = function __do() {
      var _13 = Helpers_Image.makeCanvasImageSource("images/player.png")();
      var _12 = Helpers_Image.makeCanvasImageSource("images/playerBullet.png")();
      var _11 = Helpers_Image.makeCanvasImageSource("images/invader1.png")();
      var _10 = Helpers_Image.makeCanvasImageSource("images/invader2.png")();
      var _9 = Helpers_Image.makeCanvasImageSource("images/invaderBullet.png")();
      var _8 = Helpers_Image.makeCanvasImageSource("images/invaderShot.png")();
      var _7 = Helpers_Image.makeCanvasImageSource("images/invaderDead.png")();
      var _6 = Helpers_Image.makeCanvasImageSource("images/life.png")();
      var _5 = Helpers_Image.makeCanvasImageSource("images/mysteryShip1.png")();
      var _4 = Helpers_Image.makeCanvasImageSource("images/mysteryShip2.png")();
      var _3 = Helpers_Image.makeCanvasImageSource("images/mysteryShip3.png")();
      var _2 = Helpers_Image.makeCanvasImageSource("images/mysteryShip4.png")();
      var _1 = Helpers_Image.makeCanvasImageSource("images/mysteryBullet.png")();
      return Prelude["return"](Control_Monad_Eff.applicativeEff)(new Sprites({
          player: _13, 
          playerBullet: _12, 
          invader: [ _11, _10 ], 
          invaderBullet: _9, 
          shotInvader: _8, 
          deadInvader: _7, 
          lives: _6, 
          mysteryShip: [ _5, _4, _3, _2 ], 
          mysteryBullet: _1
      }))();
  };
  var lives = Optic_Lens.lens(function (_65) {
      return _65.value0.lives;
  })(function (_66) {
      return function (lives$prime) {
          return new Sprites((function () {
              var _182 = {};
              for (var _183 in _66.value0) {
                  if (_66.value0.hasOwnProperty(_183)) {
                      _182[_183] = _66.value0[_183];
                  };
              };
              _182.lives = lives$prime;
              return _182;
          })());
      };
  });
  var invaderBullet = Optic_Lens.lens(function (_73) {
      return _73.value0.invaderBullet;
  })(function (_74) {
      return function (invaderBullet$prime) {
          return new Sprites((function () {
              var _188 = {};
              for (var _189 in _74.value0) {
                  if (_74.value0.hasOwnProperty(_189)) {
                      _188[_189] = _74.value0[_189];
                  };
              };
              _188.invaderBullet = invaderBullet$prime;
              return _188;
          })());
      };
  });
  var invader = Optic_Lens.lens(function (_71) {
      return _71.value0.invader;
  })(function (_72) {
      return function (invader$prime) {
          return new Sprites((function () {
              var _194 = {};
              for (var _195 in _72.value0) {
                  if (_72.value0.hasOwnProperty(_195)) {
                      _194[_195] = _72.value0[_195];
                  };
              };
              _194.invader = invader$prime;
              return _194;
          })());
      };
  });
  var deadInvader = Optic_Lens.lens(function (_77) {
      return _77.value0.deadInvader;
  })(function (_78) {
      return function (deadInvader$prime) {
          return new Sprites((function () {
              var _200 = {};
              for (var _201 in _78.value0) {
                  if (_78.value0.hasOwnProperty(_201)) {
                      _200[_201] = _78.value0[_201];
                  };
              };
              _200.deadInvader = deadInvader$prime;
              return _200;
          })());
      };
  });
  exports["Sprites"] = Sprites;
  exports["loadSprites"] = loadSprites;
  exports["mysteryBullet"] = mysteryBullet;
  exports["mysteryShip"] = mysteryShip;
  exports["deadInvader"] = deadInvader;
  exports["shotInvader"] = shotInvader;
  exports["invaderBullet"] = invaderBullet;
  exports["invader"] = invader;
  exports["playerBullet"] = playerBullet;
  exports["player"] = player;
  exports["lives"] = lives;;
 
})(PS["Entities.Sprites"] = PS["Entities.Sprites"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff_Random = PS["Control.Monad.Eff.Random"];
  var Data_Array = PS["Data.Array"];
  var Optic_Core = PS["Optic.Core"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];     
  var Star = (function () {
      function Star(value0) {
          this.value0 = value0;
      };
      Star.create = function (value0) {
          return new Star(value0);
      };
      return Star;
  })();
  var y = Optic_Lens.lens(function (_47) {
      return _47.value0.y;
  })(function (_48) {
      return function (y$prime) {
          return new Star((function () {
              var _94 = {};
              for (var _95 in _48.value0) {
                  if (_48.value0.hasOwnProperty(_95)) {
                      _94[_95] = _48.value0[_95];
                  };
              };
              _94.y = y$prime;
              return _94;
          })());
      };
  });
  var x = Optic_Lens.lens(function (_45) {
      return _45.value0.x;
  })(function (_46) {
      return function (x$prime) {
          return new Star((function () {
              var _100 = {};
              for (var _101 in _46.value0) {
                  if (_46.value0.hasOwnProperty(_101)) {
                      _100[_101] = _46.value0[_101];
                  };
              };
              _100.x = x$prime;
              return _100;
          })());
      };
  });
  var makeStar = function (x_1) {
      return function (y_1) {
          return new Star({
              x: x_1, 
              y: y_1
          });
      };
  };
  var generateStars = function (w) {
      return function (h) {
          var makeRandomStar = function __do() {
              var _2 = Control_Monad_Eff_Random.random();
              var _1 = Control_Monad_Eff_Random.random();
              return Prelude["return"](Control_Monad_Eff.applicativeEff)(makeStar(w * _2)(h * _1))();
          };
          return Data_Array.replicateM(Control_Monad_Eff.monadEff)(100)(makeRandomStar);
      };
  };
  exports["Star"] = Star;
  exports["generateStars"] = generateStars;
  exports["makeStar"] = makeStar;
  exports["y"] = y;
  exports["x"] = x;;
 
})(PS["Entities.Star"] = PS["Entities.Star"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Prelude = PS["Prelude"];     
  var $amp = Prelude.flip(Prelude["$"]);
  exports["&"] = $amp;;
 
})(PS["Helpers.Lens"] = PS["Helpers.Lens"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Lens = PS["Optic.Lens"];
  var Optic_Setter = PS["Optic.Setter"];
  var Optic_Getter = PS["Optic.Getter"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_Eff_Random = PS["Control.Monad.Eff.Random"];
  var Control_Monad_ST = PS["Control.Monad.ST"];
  var Data_Date = PS["Data.Date"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Time = PS["Data.Time"];
  var Graphics_Canvas = PS["Graphics.Canvas"];
  var Optic_Core = PS["Optic.Core"];
  var Entities_Bullet = PS["Entities.Bullet"];
  var Entities_Enemies = PS["Entities.Enemies"];
  var Entities_Event = PS["Entities.Event"];
  var Entities_Invader = PS["Entities.Invader"];
  var Entities_MysteryShip = PS["Entities.MysteryShip"];
  var Entities_Player = PS["Entities.Player"];
  var Entities_Sounds = PS["Entities.Sounds"];
  var Entities_Sprites = PS["Entities.Sprites"];
  var Entities_Star = PS["Entities.Star"];
  var Helpers_Audio = PS["Helpers.Audio"];
  var Helpers_Lens = PS["Helpers.Lens"];
  var Data_Identity = PS["Data.Identity"];
  var Data_Const = PS["Data.Const"];     
  var GameOver = (function () {
      function GameOver() {

      };
      GameOver.value = new GameOver();
      return GameOver;
  })();
  var Playing = (function () {
      function Playing() {

      };
      Playing.value = new Playing();
      return Playing;
  })();
  var Waiting = (function () {
      function Waiting() {

      };
      Waiting.value = new Waiting();
      return Waiting;
  })();
  var Game = (function () {
      function Game(value0) {
          this.value0 = value0;
      };
      Game.create = function (value0) {
          return new Game(value0);
      };
      return Game;
  })();
  var w = Optic_Lens.lens(function (_77) {
      return _77.value0.w;
  })(function (_78) {
      return function (w$prime) {
          return new Game((function () {
              var _190 = {};
              for (var _191 in _78.value0) {
                  if (_78.value0.hasOwnProperty(_191)) {
                      _190[_191] = _78.value0[_191];
                  };
              };
              _190.w = w$prime;
              return _190;
          })());
      };
  });
  var status = Optic_Lens.lens(function (_83) {
      return _83.value0.status;
  })(function (_84) {
      return function (status$prime) {
          return new Game((function () {
              var _196 = {};
              for (var _197 in _84.value0) {
                  if (_84.value0.hasOwnProperty(_197)) {
                      _196[_197] = _84.value0[_197];
                  };
              };
              _196.status = status$prime;
              return _196;
          })());
      };
  });
  var startTime = Optic_Lens.lens(function (_81) {
      return _81.value0.startTime;
  })(function (_82) {
      return function (startTime$prime) {
          return new Game((function () {
              var _202 = {};
              for (var _203 in _82.value0) {
                  if (_82.value0.hasOwnProperty(_203)) {
                      _202[_203] = _82.value0[_203];
                  };
              };
              _202.startTime = startTime$prime;
              return _202;
          })());
      };
  });
  var startGame = function (gRef) {
      return function __do() {
          var _14 = Control_Monad_ST.readSTRef(gRef)();
          var _13 = Data_Date.nowEpochMilliseconds();
          return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
              return Helpers_Lens["&"](Optic_Setter[".~"](status(Data_Identity.functorIdentity))(Playing.value)(g_1))(Optic_Setter[".~"](startTime(Data_Identity.functorIdentity))(_13));
          })();
      };
  };
  var stars = Optic_Lens.lens(function (_99) {
      return _99.value0.stars;
  })(function (_100) {
      return function (stars$prime) {
          return new Game((function () {
              var _210 = {};
              for (var _211 in _100.value0) {
                  if (_100.value0.hasOwnProperty(_211)) {
                      _210[_211] = _100.value0[_211];
                  };
              };
              _210.stars = stars$prime;
              return _210;
          })());
      };
  });
  var sprites = Optic_Lens.lens(function (_101) {
      return _101.value0.sprites;
  })(function (_102) {
      return function (sprites$prime) {
          return new Game((function () {
              var _216 = {};
              for (var _217 in _102.value0) {
                  if (_102.value0.hasOwnProperty(_217)) {
                      _216[_217] = _102.value0[_217];
                  };
              };
              _216.sprites = sprites$prime;
              return _216;
          })());
      };
  });
  var sounds = Optic_Lens.lens(function (_103) {
      return _103.value0.sounds;
  })(function (_104) {
      return function (sounds$prime) {
          return new Game((function () {
              var _222 = {};
              for (var _223 in _104.value0) {
                  if (_104.value0.hasOwnProperty(_223)) {
                      _222[_223] = _104.value0[_223];
                  };
              };
              _222.sounds = sounds$prime;
              return _222;
          })());
      };
  });
  var shotInvaderSprite = function (__dict_Functor_0) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sprites(__dict_Functor_0))(Entities_Sprites.shotInvader(__dict_Functor_0));
  };
  var score = Optic_Lens.lens(function (_85) {
      return _85.value0.score;
  })(function (_86) {
      return function (score$prime) {
          return new Game((function () {
              var _228 = {};
              for (var _229 in _86.value0) {
                  if (_86.value0.hasOwnProperty(_229)) {
                      _228[_229] = _86.value0[_229];
                  };
              };
              _228.score = score$prime;
              return _228;
          })());
      };
  });
  var playerSprite = function (__dict_Functor_1) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sprites(__dict_Functor_1))(Entities_Sprites.player(__dict_Functor_1));
  };
  var playerShotSound = function (__dict_Functor_2) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sounds(__dict_Functor_2))(Entities_Sounds.playerShot(__dict_Functor_2));
  };
  var playerBullets = Optic_Lens.lens(function (_91) {
      return _91.value0.playerBullets;
  })(function (_92) {
      return function (playerBullets$prime) {
          return new Game((function () {
              var _234 = {};
              for (var _235 in _92.value0) {
                  if (_92.value0.hasOwnProperty(_235)) {
                      _234[_235] = _92.value0[_235];
                  };
              };
              _234.playerBullets = playerBullets$prime;
              return _234;
          })());
      };
  });
  var playerBulletSprite = function (__dict_Functor_3) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sprites(__dict_Functor_3))(Entities_Sprites.playerBullet(__dict_Functor_3));
  };
  var player = Optic_Lens.lens(function (_89) {
      return _89.value0.player;
  })(function (_90) {
      return function (player$prime) {
          return new Game((function () {
              var _240 = {};
              for (var _241 in _90.value0) {
                  if (_90.value0.hasOwnProperty(_241)) {
                      _240[_241] = _90.value0[_241];
                  };
              };
              _240.player = player$prime;
              return _240;
          })());
      };
  });
  var playerX = function (__dict_Functor_4) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(player(__dict_Functor_4))(Entities_Player.x(__dict_Functor_4));
  };
  var playerY = function (__dict_Functor_5) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(player(__dict_Functor_5))(Entities_Player.y(__dict_Functor_5));
  };
  var newPlayerBulletSound = function (__dict_Functor_6) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sounds(__dict_Functor_6))(Entities_Sounds.newPlayerBullet(__dict_Functor_6));
  };
  var newMysteryShipSound = function (__dict_Functor_7) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sounds(__dict_Functor_7))(Entities_Sounds.newMysteryShip(__dict_Functor_7));
  };
  var newMysteryBulletSound = function (__dict_Functor_8) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sounds(__dict_Functor_8))(Entities_Sounds.newMysteryBullet(__dict_Functor_8));
  };
  var newInvaderBulletSound = function (__dict_Functor_9) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sounds(__dict_Functor_9))(Entities_Sounds.newInvaderBullet(__dict_Functor_9));
  };
  var mysteryShipSprites = function (__dict_Functor_10) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sprites(__dict_Functor_10))(Entities_Sprites.mysteryShip(__dict_Functor_10));
  };
  var mysteryShipShotSound = function (__dict_Functor_11) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sounds(__dict_Functor_11))(Entities_Sounds.mysteryShipShot(__dict_Functor_11));
  };
  var mysteryBulletSprite = function (__dict_Functor_12) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sprites(__dict_Functor_12))(Entities_Sprites.mysteryBullet(__dict_Functor_12));
  };
  var makeGame = function (w_1) {
      return function (h_1) {
          var player_1 = Entities_Player.makePlayer(0.5 * w_1)(0.9 * h_1);
          return function __do() {
              var _12 = Entities_Sprites.loadSprites();
              var _11 = Entities_Sounds.loadAllSounds();
              var _10 = Data_Date.nowEpochMilliseconds();
              var _9 = Entities_Star.generateStars(w_1)(h_1)();
              return Prelude["return"](Control_Monad_Eff.applicativeEff)(new Game({
                  w: w_1, 
                  h: h_1, 
                  startTime: _10, 
                  status: Waiting.value, 
                  score: 0, 
                  lives: 3, 
                  player: player_1, 
                  playerBullets: [  ], 
                  invaderBullets: [  ], 
                  enemies: Entities_Enemies.makeRegularLevel, 
                  events: [  ], 
                  stars: _9, 
                  sprites: _12, 
                  sounds: _11
              }))();
          };
      };
  };
  var lives = Optic_Lens.lens(function (_87) {
      return _87.value0.lives;
  })(function (_88) {
      return function (lives$prime) {
          return new Game((function () {
              var _250 = {};
              for (var _251 in _88.value0) {
                  if (_88.value0.hasOwnProperty(_251)) {
                      _250[_251] = _88.value0[_251];
                  };
              };
              _250.lives = lives$prime;
              return _250;
          })());
      };
  });
  var lifeSprite = function (__dict_Functor_13) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sprites(__dict_Functor_13))(Entities_Sprites.lives(__dict_Functor_13));
  };
  var invaderSprites = function (__dict_Functor_14) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sprites(__dict_Functor_14))(Entities_Sprites.invader(__dict_Functor_14));
  };
  var invaderShotSound = function (__dict_Functor_15) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sounds(__dict_Functor_15))(Entities_Sounds.invaderShot(__dict_Functor_15));
  };
  var invaderBullets = Optic_Lens.lens(function (_93) {
      return _93.value0.invaderBullets;
  })(function (_94) {
      return function (invaderBullets$prime) {
          return new Game((function () {
              var _256 = {};
              for (var _257 in _94.value0) {
                  if (_94.value0.hasOwnProperty(_257)) {
                      _256[_257] = _94.value0[_257];
                  };
              };
              _256.invaderBullets = invaderBullets$prime;
              return _256;
          })());
      };
  });
  var invaderBulletSprite = function (__dict_Functor_16) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sprites(__dict_Functor_16))(Entities_Sprites.invaderBullet(__dict_Functor_16));
  };
  var h = Optic_Lens.lens(function (_79) {
      return _79.value0.h;
  })(function (_80) {
      return function (h$prime) {
          return new Game((function () {
              var _262 = {};
              for (var _263 in _80.value0) {
                  if (_80.value0.hasOwnProperty(_263)) {
                      _262[_263] = _80.value0[_263];
                  };
              };
              _262.h = h$prime;
              return _262;
          })());
      };
  });
  var events = Optic_Lens.lens(function (_97) {
      return _97.value0.events;
  })(function (_98) {
      return function (events$prime) {
          return new Game((function () {
              var _268 = {};
              for (var _269 in _98.value0) {
                  if (_98.value0.hasOwnProperty(_269)) {
                      _268[_269] = _98.value0[_269];
                  };
              };
              _268.events = events$prime;
              return _268;
          })());
      };
  });
  var enemies = Optic_Lens.lens(function (_95) {
      return _95.value0.enemies;
  })(function (_96) {
      return function (enemies$prime) {
          return new Game((function () {
              var _274 = {};
              for (var _275 in _96.value0) {
                  if (_96.value0.hasOwnProperty(_275)) {
                      _274[_275] = _96.value0[_275];
                  };
              };
              _274.enemies = enemies$prime;
              return _274;
          })());
      };
  });
  var invaders = function (__dict_Functor_17) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(enemies(__dict_Functor_17))(Entities_Enemies.invaders(__dict_Functor_17));
  };
  var mysteryShip = function (__dict_Functor_18) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(enemies(__dict_Functor_18))(Entities_Enemies.mysteryShip(__dict_Functor_18));
  };
  var patrolDirection = function (__dict_Functor_19) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(enemies(__dict_Functor_19))(Entities_Enemies.direction(__dict_Functor_19));
  };
  var patrolDx = function (__dict_Functor_20) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(enemies(__dict_Functor_20))(Entities_Enemies.dx(__dict_Functor_20));
  };
  var restartGame = function (gRef) {
      return function __do() {
          var _16 = Control_Monad_ST.readSTRef(gRef)();
          var _15 = Data_Date.nowEpochMilliseconds();
          return (function () {
              var newPlayer = Entities_Player.makePlayer(0.5 * Optic_Getter["^."](_16)(w(Data_Const.functorConst)))(0.9 * Optic_Getter["^."](_16)(h(Data_Const.functorConst)));
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Optic_Setter[".~"](status(Data_Identity.functorIdentity))(Playing.value)(g_1))(Optic_Setter[".~"](player(Data_Identity.functorIdentity))(newPlayer)))(Optic_Setter[".~"](startTime(Data_Identity.functorIdentity))(_15)))(Optic_Setter[".~"](score(Data_Identity.functorIdentity))(0)))(Optic_Setter[".~"](lives(Data_Identity.functorIdentity))(3)))(Optic_Setter[".~"](enemies(Data_Identity.functorIdentity))(Entities_Enemies.makeRegularLevel)))(Optic_Setter[".~"](playerBullets(Data_Identity.functorIdentity))([  ])))(Optic_Setter[".~"](invaderBullets(Data_Identity.functorIdentity))([  ])))(Optic_Setter[".~"](events(Data_Identity.functorIdentity))([  ]));
              });
          })()();
      };
  };
  var deadInvaderSprite = function (__dict_Functor_21) {
      return Optic_Core[".."](Prelude.semigroupoidFn)(sprites(__dict_Functor_21))(Entities_Sprites.deadInvader(__dict_Functor_21));
  };
  exports["Game"] = Game;
  exports["GameOver"] = GameOver;
  exports["Playing"] = Playing;
  exports["Waiting"] = Waiting;
  exports["restartGame"] = restartGame;
  exports["startGame"] = startGame;
  exports["makeGame"] = makeGame;
  exports["playerShotSound"] = playerShotSound;
  exports["mysteryShipShotSound"] = mysteryShipShotSound;
  exports["invaderShotSound"] = invaderShotSound;
  exports["newMysteryBulletSound"] = newMysteryBulletSound;
  exports["newMysteryShipSound"] = newMysteryShipSound;
  exports["newInvaderBulletSound"] = newInvaderBulletSound;
  exports["newPlayerBulletSound"] = newPlayerBulletSound;
  exports["mysteryBulletSprite"] = mysteryBulletSprite;
  exports["mysteryShipSprites"] = mysteryShipSprites;
  exports["deadInvaderSprite"] = deadInvaderSprite;
  exports["shotInvaderSprite"] = shotInvaderSprite;
  exports["invaderBulletSprite"] = invaderBulletSprite;
  exports["invaderSprites"] = invaderSprites;
  exports["playerBulletSprite"] = playerBulletSprite;
  exports["playerSprite"] = playerSprite;
  exports["lifeSprite"] = lifeSprite;
  exports["mysteryShip"] = mysteryShip;
  exports["patrolDx"] = patrolDx;
  exports["patrolDirection"] = patrolDirection;
  exports["invaders"] = invaders;
  exports["playerY"] = playerY;
  exports["playerX"] = playerX;
  exports["sounds"] = sounds;
  exports["sprites"] = sprites;
  exports["stars"] = stars;
  exports["events"] = events;
  exports["enemies"] = enemies;
  exports["invaderBullets"] = invaderBullets;
  exports["playerBullets"] = playerBullets;
  exports["player"] = player;
  exports["lives"] = lives;
  exports["score"] = score;
  exports["status"] = status;
  exports["startTime"] = startTime;
  exports["h"] = h;
  exports["w"] = w;;
 
})(PS["Entities.Game"] = PS["Entities.Game"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Getter = PS["Optic.Getter"];
  var Optic_Setter = PS["Optic.Setter"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_ST = PS["Control.Monad.ST"];
  var Data_Array = PS["Data.Array"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Tuple = PS["Data.Tuple"];
  var $$Math = PS["Math"];
  var Optic_Core = PS["Optic.Core"];
  var Entities_Bullet = PS["Entities.Bullet"];
  var Entities_Game = PS["Entities.Game"];
  var Entities_Event = PS["Entities.Event"];
  var Entities_Invader = PS["Entities.Invader"];
  var Entities_MysteryShip = PS["Entities.MysteryShip"];
  var Entities_Player = PS["Entities.Player"];
  var Helpers_Lens = PS["Helpers.Lens"];
  var Data_Const = PS["Data.Const"];
  var Data_Identity = PS["Data.Identity"];     
  var Shootable = function (isShot) {
      this.isShot = isShot;
  };
  var shootablePlayer = new Shootable(function (p) {
      return function (b) {
          return $$Math.abs(Optic_Getter["^."](p)(Entities_Player.x(Data_Const.functorConst)) - Optic_Getter["^."](b)(Entities_Bullet.x(Data_Const.functorConst))) < 25.0 && $$Math.abs(Optic_Getter["^."](p)(Entities_Player.y(Data_Const.functorConst)) - Optic_Getter["^."](b)(Entities_Bullet.y(Data_Const.functorConst))) < 25.0;
      };
  });
  var shootableMysteryShip = new Shootable(function (m) {
      return function (b) {
          return Prelude["=="](Entities_MysteryShip.eqStatus)(Optic_Getter["^."](m)(Entities_MysteryShip.status(Data_Const.functorConst)))(Entities_MysteryShip.Alive.value) && ($$Math.abs(Optic_Getter["^."](m)(Entities_MysteryShip.x(Data_Const.functorConst)) - Optic_Getter["^."](b)(Entities_Bullet.x(Data_Const.functorConst))) < 50.0 && $$Math.abs(Optic_Getter["^."](m)(Entities_MysteryShip.y(Data_Const.functorConst)) - Optic_Getter["^."](b)(Entities_Bullet.y(Data_Const.functorConst))) < 25.0);
      };
  });
  var shootableInvader = new Shootable(function (i) {
      return function (b) {
          return Prelude["=="](Entities_Invader.eqStatus)(Optic_Getter["^."](i)(Entities_Invader.status(Data_Const.functorConst)))(Entities_Invader.Alive.value) && ($$Math.abs(Optic_Getter["^."](i)(Entities_Invader.x(Data_Const.functorConst)) - Optic_Getter["^."](b)(Entities_Bullet.x(Data_Const.functorConst))) < 25.0 && $$Math.abs(Optic_Getter["^."](i)(Entities_Invader.y(Data_Const.functorConst)) - Optic_Getter["^."](b)(Entities_Bullet.y(Data_Const.functorConst))) < 25.0);
      };
  });
  var isShot = function (dict) {
      return dict.isShot;
  };
  var checkPlayerShot = function (gRef) {
      return function __do() {
          var _17 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var player = Optic_Getter["^."](_17)(Entities_Game.player(Data_Const.functorConst));
              var go = function (_110) {
                  if (_110) {
                      return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                          return Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Optic_Setter["-~"](Prelude.ringInt)(Entities_Game.lives(Data_Identity.functorIdentity))(1)(g_1))(Optic_Setter[".~"](Entities_Game.playerBullets(Data_Identity.functorIdentity))([  ])))(Optic_Setter[".~"](Entities_Game.invaderBullets(Data_Identity.functorIdentity))([  ])))(Optic_Setter[".~"](Entities_Game.events(Data_Identity.functorIdentity))([ new Entities_Event.Event(Entities_Event.PlayerShot.value, Entities_Event.New.value) ]));
                      });
                  };
                  return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                      return g_1;
                  });
              };
              var currBullets = Optic_Getter["^."](_17)(Entities_Game.invaderBullets(Data_Const.functorConst));
              var isDead = (function (_0) {
                  return _0 > 0;
              })(Data_Array.length(Data_Array.filter(isShot(shootablePlayer)(player))(currBullets)));
              return go(isDead);
          })()();
      };
  };
  var checkMysteryShipShot = function (gRef) {
      return function __do() {
          var _22 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var mysteryShip = Optic_Getter["^."](_22)(Entities_Game.mysteryShip(Data_Const.functorConst));
              var currBullets = Optic_Getter["^."](_22)(Entities_Game.playerBullets(Data_Const.functorConst));
              var go = function (_111) {
                  if (_111 instanceof Data_Maybe.Nothing) {
                      return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                          return g_1;
                      });
                  };
                  if (_111 instanceof Data_Maybe.Just) {
                      var newMysteryShip = function (_112) {
                          if (_112) {
                              return Data_Maybe.Just.create(Optic_Setter[".~"](Entities_MysteryShip.status(Data_Identity.functorIdentity))(Entities_MysteryShip.Shot.value)(_111.value0));
                          };
                          return new Data_Maybe.Just(_111.value0);
                      };
                      var currEvents = Optic_Getter["^."](_22)(Entities_Game.events(Data_Const.functorConst));
                      var collisions = Data_Array.filter(function (_108) {
                          return isShot(shootableMysteryShip)(_108.value0)(_108.value1);
                      })(Prelude.bind(Prelude.bindArray)(currBullets)(function (_21) {
                          return Prelude["return"](Prelude.applicativeArray)(new Data_Tuple.Tuple(_111.value0, _21));
                      }));
                      var deadBullets = Prelude.map(Prelude.functorArray)(function (_109) {
                          return _109.value1;
                      })(collisions);
                      var newBullets = Data_Array["\\\\"](Entities_Bullet.eqBullet)(currBullets)(deadBullets);
                      var isShot$prime = (function (_1) {
                          return _1 > 0;
                      })(Data_Array.length(collisions));
                      var go_1 = function (_113) {
                          if (_113) {
                              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                                  return Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Optic_Setter[".~"](Entities_Game.playerBullets(Data_Identity.functorIdentity))(newBullets)(g_1))(Optic_Setter[".~"](Entities_Game.mysteryShip(Data_Identity.functorIdentity))(newMysteryShip(isShot$prime))))(Optic_Setter["+~"](Prelude.semiringInt)(Entities_Game.score(Data_Identity.functorIdentity))(1000)))(Optic_Setter[".~"](Entities_Game.events(Data_Identity.functorIdentity))([ new Entities_Event.Event(Entities_Event.MysteryShipShot.value, Entities_Event.New.value) ]));
                              });
                          };
                          return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                              return g_1;
                          });
                      };
                      return go_1(isShot$prime);
                  };
                  throw new Error("Failed pattern match at Handlers.Collision line 89, column 1 - line 91, column 1: " + [ _111.constructor.name ]);
              };
              return go(mysteryShip);
          })()();
      };
  };
  var checkInvadersShot = function (gRef) {
      return function __do() {
          var _20 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var currInvaders = Optic_Getter["^."](_20)(Entities_Game.invaders(Data_Const.functorConst));
              var currEvents = Optic_Getter["^."](_20)(Entities_Game.events(Data_Const.functorConst));
              var currBullets = Optic_Getter["^."](_20)(Entities_Game.playerBullets(Data_Const.functorConst));
              var collisions = Data_Array.filter(function (_105) {
                  return isShot(shootableInvader)(_105.value0)(_105.value1);
              })(Prelude.bind(Prelude.bindArray)(currInvaders)(function (_19) {
                  return Prelude.bind(Prelude.bindArray)(currBullets)(function (_18) {
                      return Prelude["return"](Prelude.applicativeArray)(new Data_Tuple.Tuple(_19, _18));
                  });
              }));
              var deadBullets = Prelude.map(Prelude.functorArray)(function (_107) {
                  return _107.value1;
              })(collisions);
              var newBullets = Data_Array["\\\\"](Entities_Bullet.eqBullet)(currBullets)(deadBullets);
              var shotInvaders = Data_Array.nub(Entities_Invader.eqInvader)(Prelude.map(Prelude.functorArray)(function (_106) {
                  return Optic_Setter[".~"](Entities_Invader.status(Data_Identity.functorIdentity))(Entities_Invader.Shot.value)(_106.value0);
              })(collisions));
              var newEvents = (function () {
                  if (Data_Array.length(shotInvaders) > 0) {
                      return Data_Array.cons(new Entities_Event.Event(Entities_Event.InvaderShot.value, Entities_Event.New.value))(currEvents);
                  };
                  if (Prelude.otherwise) {
                      return currEvents;
                  };
                  throw new Error("Failed pattern match at Handlers.Collision line 62, column 1 - line 64, column 1: " + [  ]);
              })();
              var newPoints = 100 * Data_Array.length(shotInvaders) | 0;
              var otherInvaders = Data_Array["\\\\"](Entities_Invader.eqInvader)(currInvaders)(shotInvaders);
              var newInvaders = Data_Array.concat([ otherInvaders, shotInvaders ]);
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Optic_Setter[".~"](Entities_Game.invaders(Data_Identity.functorIdentity))(newInvaders)(g_1))(Optic_Setter[".~"](Entities_Game.playerBullets(Data_Identity.functorIdentity))(newBullets)))(Optic_Setter["+~"](Prelude.semiringInt)(Entities_Game.score(Data_Identity.functorIdentity))(newPoints)))(Optic_Setter[".~"](Entities_Game.events(Data_Identity.functorIdentity))(newEvents));
              });
          })()();
      };
  };
  exports["Shootable"] = Shootable;
  exports["checkMysteryShipShot"] = checkMysteryShipShot;
  exports["checkInvadersShot"] = checkInvadersShot;
  exports["checkPlayerShot"] = checkPlayerShot;
  exports["isShot"] = isShot;
  exports["shootableInvader"] = shootableInvader;
  exports["shootableMysteryShip"] = shootableMysteryShip;
  exports["shootablePlayer"] = shootablePlayer;;
 
})(PS["Handlers.Collision"] = PS["Handlers.Collision"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Getter = PS["Optic.Getter"];
  var Optic_Setter = PS["Optic.Setter"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_ST = PS["Control.Monad.ST"];
  var Data_Array = PS["Data.Array"];
  var Optic_Core = PS["Optic.Core"];
  var Entities_Event = PS["Entities.Event"];
  var Entities_Game = PS["Entities.Game"];
  var Helpers_Audio = PS["Helpers.Audio"];
  var Data_Const = PS["Data.Const"];
  var Data_Identity = PS["Data.Identity"];     
  var processEvent = function (_114) {
      return function (g) {
          if (_114.value0 instanceof Entities_Event.PlayerShot) {
              return Helpers_Audio.playSound(Optic_Getter["^."](g)(Entities_Game.playerShotSound(Data_Const.functorConst)));
          };
          if (_114.value0 instanceof Entities_Event.InvaderShot) {
              return Helpers_Audio.playSound(Optic_Getter["^."](g)(Entities_Game.invaderShotSound(Data_Const.functorConst)));
          };
          if (_114.value0 instanceof Entities_Event.NewInvaderBullet) {
              return Helpers_Audio.playSound(Optic_Getter["^."](g)(Entities_Game.newInvaderBulletSound(Data_Const.functorConst)));
          };
          if (_114.value0 instanceof Entities_Event.NewMysteryShip) {
              return Helpers_Audio.playSound(Optic_Getter["^."](g)(Entities_Game.newMysteryShipSound(Data_Const.functorConst)));
          };
          if (_114.value0 instanceof Entities_Event.NewMysteryBullet) {
              return Helpers_Audio.playSound(Optic_Getter["^."](g)(Entities_Game.newMysteryBulletSound(Data_Const.functorConst)));
          };
          if (_114.value0 instanceof Entities_Event.GoneMysteryShip) {
              return Helpers_Audio.stopSound(Optic_Getter["^."](g)(Entities_Game.newMysteryShipSound(Data_Const.functorConst)));
          };
          if (_114.value0 instanceof Entities_Event.MysteryShipShot) {
              return function __do() {
                  Helpers_Audio.stopSound(Optic_Getter["^."](g)(Entities_Game.newMysteryShipSound(Data_Const.functorConst)))();
                  return Helpers_Audio.playSound(Optic_Getter["^."](g)(Entities_Game.mysteryShipShotSound(Data_Const.functorConst)))();
              };
          };
          return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit);
      };
  };
  var processEvents = function (gRef) {
      return function __do() {
          var _24 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var currEvents = Optic_Getter["^."](_24)(Entities_Game.events(Data_Const.functorConst));
              var newEvents = Prelude.map(Prelude.functorArray)(function (e) {
                  return Optic_Setter[".~"](Entities_Event.status(Data_Identity.functorIdentity))(Entities_Event.Handled.value)(e);
              })(currEvents);
              var unhandledEvents = Data_Array.filter(function (e) {
                  return Prelude["=="](Entities_Event.eqStatus)(Optic_Getter["^."](e)(Entities_Event.status(Data_Const.functorConst)))(Entities_Event.New.value);
              })(currEvents);
              return function __do() {
                  Control_Monad_Eff.foreachE(unhandledEvents)(function (event) {
                      return function __do() {
                          processEvent(event)(_24)();
                          return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                      };
                  })();
                  Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                      return Optic_Setter[".~"](Entities_Game.events(Data_Identity.functorIdentity))(newEvents)(g_1);
                  })();
                  return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
              };
          })()();
      };
  };
  var clearHandledEvents = function (gRef) {
      return function __do() {
          var _23 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var currEvents = Optic_Getter["^."](_23)(Entities_Game.events(Data_Const.functorConst));
              var unhandledEvents = Data_Array.filter(function (e) {
                  return Prelude["=="](Entities_Event.eqStatus)(Optic_Getter["^."](e)(Entities_Event.status(Data_Const.functorConst)))(Entities_Event.New.value);
              })(currEvents);
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Optic_Setter[".~"](Entities_Game.events(Data_Identity.functorIdentity))(unhandledEvents)(g_1);
              });
          })()();
      };
  };
  exports["processEvents"] = processEvents;
  exports["clearHandledEvents"] = clearHandledEvents;
  exports["processEvent"] = processEvent;;
 
})(PS["Handlers.Event"] = PS["Handlers.Event"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Getter = PS["Optic.Getter"];
  var Optic_Setter = PS["Optic.Setter"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_Eff_Random = PS["Control.Monad.Eff.Random"];
  var Control_Monad_ST = PS["Control.Monad.ST"];
  var Data_Array = PS["Data.Array"];
  var Data_Date = PS["Data.Date"];
  var Data_Int = PS["Data.Int"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Maybe_Unsafe = PS["Data.Maybe.Unsafe"];
  var Data_Time = PS["Data.Time"];
  var $$Math = PS["Math"];
  var Optic_Core = PS["Optic.Core"];
  var Entities_Bullet = PS["Entities.Bullet"];
  var Entities_Event = PS["Entities.Event"];
  var Entities_Game = PS["Entities.Game"];
  var Entities_Invader = PS["Entities.Invader"];
  var Entities_MysteryShip = PS["Entities.MysteryShip"];
  var Entities_Star = PS["Entities.Star"];
  var Helpers_Lens = PS["Helpers.Lens"];
  var Data_Const = PS["Data.Const"];
  var Data_Identity = PS["Data.Identity"];
  var Data_Profunctor = PS["Data.Profunctor"];     
  var isBeginningOfCycle = function (_115) {
      return function (c) {
          return _115 >= c && $$Math["%"](_115)(c) < 5.0e-2;
      };
  };
  var possiblyGenerateMysteryShip = function (gRef) {
      return function __do() {
          var _34 = Control_Monad_ST.readSTRef(gRef)();
          var _33 = Data_Date.nowEpochMilliseconds();
          return (function () {
              var secondsIntoGame = Data_Time.toSeconds(Data_Time.timeValueMilliseconds)(Prelude["-"](Data_Time.ringMilliseconds)(_33)(Optic_Getter["^."](_34)(Entities_Game.startTime(Data_Const.functorConst))));
              var go = function (_119) {
                  return function (_120) {
                      if (_119 instanceof Data_Maybe.Nothing && _120) {
                          var newEvent = new Entities_Event.Event(Entities_Event.NewMysteryShip.value, Entities_Event.New.value);
                          return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                              return Helpers_Lens["&"](Optic_Setter[".~"](Entities_Game.mysteryShip(Data_Identity.functorIdentity))(Data_Maybe.Just.create(Entities_MysteryShip.makeMysteryShip(-100.0)(75.0)))(g_1))(Optic_Setter["%~"](Data_Profunctor.profunctorFn)(Entities_Game.events(Data_Identity.functorIdentity))(Data_Array.cons(newEvent)));
                          });
                      };
                      return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                          return g_1;
                      });
                  };
              };
              var currMysteryShip = Optic_Getter["^."](_34)(Entities_Game.mysteryShip(Data_Const.functorConst));
              var beginningOfCycle = isBeginningOfCycle(secondsIntoGame)(7.0);
              return go(currMysteryShip)(beginningOfCycle);
          })()();
      };
  };
  var generateStars = function (gRef) {
      return function __do() {
          var _28 = Control_Monad_ST.readSTRef(gRef)();
          var _27 = Control_Monad_Eff_Random.random();
          return (function () {
              var maybeMakeNewStar = function (coinToss_1) {
                  return function (gRef_1) {
                      if (coinToss_1 < 0.25) {
                          return function __do() {
                              var _26 = Control_Monad_Eff_Random.random();
                              return (function () {
                                  var newStar = Entities_Star.makeStar(Optic_Getter["^."](_28)(Entities_Game.w(Data_Const.functorConst)) * _26)(Optic_Getter["^."](_28)(Entities_Game.h(Data_Const.functorConst)));
                                  return Control_Monad_ST.modifySTRef(gRef_1)(function (g_1) {
                                      return Optic_Setter["%~"](Data_Profunctor.profunctorFn)(Entities_Game.stars(Data_Identity.functorIdentity))(Data_Array.cons(newStar))(g_1);
                                  });
                              })()();
                          };
                      };
                      if (Prelude.otherwise) {
                          return Control_Monad_ST.readSTRef(gRef_1);
                      };
                      throw new Error("Failed pattern match at Handlers.Generation line 43, column 7 - line 44, column 7: " + [ coinToss_1.constructor.name, gRef_1.constructor.name ]);
                  };
              };
              var currStars = Optic_Getter["^."](_28)(Entities_Game.stars(Data_Const.functorConst));
              return maybeMakeNewStar(_27)(gRef);
          })()();
      };
  };
  var generateMysteryShipBullets = function (gRef) {
      return function __do() {
          var _30 = Control_Monad_ST.readSTRef(gRef)();
          var _29 = Data_Date.nowEpochMilliseconds();
          return (function () {
              var millisecondsIntoGame = Prelude["-"](Data_Time.ringMilliseconds)(_29)(Optic_Getter["^."](_30)(Entities_Game.startTime(Data_Const.functorConst)));
              var isOnBulletCycle = function (_116) {
                  var m$prime = Data_Maybe_Unsafe.fromJust(Data_Int.fromNumber($$Math.floor(_116)));
                  return m$prime >= 500 && m$prime % 500 < 50;
              };
              var go = function (_117) {
                  return function (_118) {
                      if (_117 instanceof Data_Maybe.Just && _118) {
                          var newBullets = Prelude.map(Prelude.functorArray)(function (dx) {
                              return Entities_Bullet.makeMysteryBullet(Optic_Getter["^."](_117.value0)(Entities_MysteryShip.x(Data_Const.functorConst)) + dx)(Optic_Getter["^."](_117.value0)(Entities_MysteryShip.y(Data_Const.functorConst)) + 25.0);
                          })([ -25.0, 0.0, 25.0 ]);
                          return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                              return Helpers_Lens["&"](Optic_Setter["%~"](Data_Profunctor.profunctorFn)(Entities_Game.invaderBullets(Data_Identity.functorIdentity))(function (currBullets) {
                                  return Data_Array.concat([ currBullets, newBullets ]);
                              })(g_1))(Optic_Setter["%~"](Data_Profunctor.profunctorFn)(Entities_Game.events(Data_Identity.functorIdentity))(Data_Array.cons(new Entities_Event.Event(Entities_Event.NewMysteryBullet.value, Entities_Event.New.value))));
                          });
                      };
                      return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                          return g_1;
                      });
                  };
              };
              var currMysteryShip = Optic_Getter["^."](_30)(Entities_Game.mysteryShip(Data_Const.functorConst));
              return go(currMysteryShip)(isOnBulletCycle(millisecondsIntoGame));
          })()();
      };
  };
  var generateInvaderBullets = function (gRef) {
      return function __do() {
          var _32 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var maybeMakeNewInvaderBullet = function (r) {
                  return function (i) {
                      if (r < 5.0e-3) {
                          var newInvaderBullet = Entities_Bullet.makeInvaderBullet(Optic_Getter["^."](i)(Entities_Invader.x(Data_Const.functorConst)))(Optic_Getter["^."](i)(Entities_Invader.y(Data_Const.functorConst)) + 25.0);
                          return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                              return Helpers_Lens["&"](Optic_Setter["%~"](Data_Profunctor.profunctorFn)(Entities_Game.invaderBullets(Data_Identity.functorIdentity))(Data_Array.cons(newInvaderBullet))(g_1))(Optic_Setter["%~"](Data_Profunctor.profunctorFn)(Entities_Game.events(Data_Identity.functorIdentity))(Data_Array.cons(new Entities_Event.Event(Entities_Event.NewInvaderBullet.value, Entities_Event.New.value))));
                          });
                      };
                      if (Prelude.otherwise) {
                          return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                              return g_1;
                          });
                      };
                      throw new Error("Failed pattern match at Handlers.Generation line 86, column 7 - line 87, column 7: " + [ r.constructor.name, i.constructor.name ]);
                  };
              };
              var currInvaders = Optic_Getter["^."](_32)(Entities_Game.invaders(Data_Const.functorConst));
              return function __do() {
                  Control_Monad_Eff.foreachE(currInvaders)(function (i) {
                      return function __do() {
                          var _31 = Control_Monad_Eff_Random.random();
                          maybeMakeNewInvaderBullet(_31)(i)();
                          return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                      };
                  })();
                  return Control_Monad_ST.readSTRef(gRef)();
              };
          })()();
      };
  };
  var generateEverything = function (gRef) {
      return function __do() {
          Control_Monad_Eff.foreachE([ generateStars, generateInvaderBullets, generateMysteryShipBullets, possiblyGenerateMysteryShip ])(function (f) {
              return function __do() {
                  f(gRef)();
                  return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
              };
          })();
          return Control_Monad_ST.readSTRef(gRef)();
      };
  };
  var createPlayerBullet = function (gRef) {
      return function __do() {
          var _25 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var newPlayerBullet = Entities_Bullet.makePlayerBullet(Optic_Getter["^."](_25)(Entities_Game.playerX(Data_Const.functorConst)))(Optic_Getter["^."](_25)(Entities_Game.playerY(Data_Const.functorConst)));
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Optic_Setter["%~"](Data_Profunctor.profunctorFn)(Entities_Game.playerBullets(Data_Identity.functorIdentity))(Data_Array.cons(newPlayerBullet))(g_1);
              });
          })()();
      };
  };
  exports["generateEverything"] = generateEverything;
  exports["possiblyGenerateMysteryShip"] = possiblyGenerateMysteryShip;
  exports["isBeginningOfCycle"] = isBeginningOfCycle;
  exports["generateInvaderBullets"] = generateInvaderBullets;
  exports["generateMysteryShipBullets"] = generateMysteryShipBullets;
  exports["generateStars"] = generateStars;
  exports["createPlayerBullet"] = createPlayerBullet;;
 
})(PS["Handlers.Generation"] = PS["Handlers.Generation"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Setter = PS["Optic.Setter"];
  var Optic_Getter = PS["Optic.Getter"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_ST = PS["Control.Monad.ST"];
  var Data_Date = PS["Data.Date"];
  var DOM_Event_EventTarget = PS["DOM.Event.EventTarget"];
  var DOM_Event_Types = PS["DOM.Event.Types"];
  var Optic_Core = PS["Optic.Core"];
  var Unsafe_Coerce = PS["Unsafe.Coerce"];
  var Entities_Game = PS["Entities.Game"];
  var Handlers_Generation = PS["Handlers.Generation"];
  var Helpers_Audio = PS["Helpers.Audio"];
  var Data_Identity = PS["Data.Identity"];
  var Data_Const = PS["Data.Const"];     
  var Left = (function () {
      function Left() {

      };
      Left.value = new Left();
      return Left;
  })();
  var Right = (function () {
      function Right() {

      };
      Right.value = new Right();
      return Right;
  })();
  var SpaceBar = (function () {
      function SpaceBar() {

      };
      SpaceBar.value = new SpaceBar();
      return SpaceBar;
  })();
  var S = (function () {
      function S() {

      };
      S.value = new S();
      return S;
  })();
  var Other = (function () {
      function Other() {

      };
      Other.value = new Other();
      return Other;
  })();
  var movePlayer = function (key) {
      return function (gRef) {
          var dx = (function () {
              if (key instanceof Left) {
                  return -10.0;
              };
              if (key instanceof Right) {
                  return 10.0;
              };
              return 0.0;
          })();
          return Control_Monad_ST.modifySTRef(gRef)(function (g) {
              return Optic_Setter["+~"](Prelude.semiringNumber)(Entities_Game.playerX(Data_Identity.functorIdentity))(dx)(g);
          });
      };
  };
  var respondToKey = function (_121) {
      return function (_122) {
          return function (gRef) {
              if (_121 instanceof Left && _122 instanceof Entities_Game.Playing) {
                  return movePlayer(Left.value)(gRef);
              };
              if (_121 instanceof Right && _122 instanceof Entities_Game.Playing) {
                  return movePlayer(Right.value)(gRef);
              };
              if (_121 instanceof SpaceBar && _122 instanceof Entities_Game.Playing) {
                  return function __do() {
                      var _35 = Control_Monad_ST.readSTRef(gRef)();
                      Helpers_Audio.playSound(Optic_Getter["^."](_35)(Entities_Game.newPlayerBulletSound(Data_Const.functorConst)))();
                      return Handlers_Generation.createPlayerBullet(gRef)();
                  };
              };
              if (_121 instanceof S && _122 instanceof Entities_Game.Waiting) {
                  return Entities_Game.startGame(gRef);
              };
              if (_121 instanceof S && _122 instanceof Entities_Game.GameOver) {
                  return Entities_Game.restartGame(gRef);
              };
              return Control_Monad_ST.readSTRef(gRef);
          };
      };
  };
  var eventToKeyboardEvent = Unsafe_Coerce.unsafeCoerce;
  var onKeydown = function (gRef) {
      return DOM_Event_EventTarget.eventListener(function (evt) {
          return function __do() {
              var _36 = Control_Monad_ST.readSTRef(gRef)();
              return (function () {
                  var keyboardEvent = eventToKeyboardEvent(evt);
                  var gameStatus = Optic_Getter["^."](_36)(Entities_Game.status(Data_Const.functorConst));
                  var key = (function () {
                      if (keyboardEvent.keyCode === 32) {
                          return SpaceBar.value;
                      };
                      if (keyboardEvent.keyCode === 37) {
                          return Left.value;
                      };
                      if (keyboardEvent.keyCode === 39) {
                          return Right.value;
                      };
                      if (keyboardEvent.keyCode === 83) {
                          return S.value;
                      };
                      return Other.value;
                  })();
                  return respondToKey(key)(gameStatus)(gRef);
              })()();
          };
      });
  };
  exports["Left"] = Left;
  exports["Right"] = Right;
  exports["SpaceBar"] = SpaceBar;
  exports["S"] = S;
  exports["Other"] = Other;
  exports["onKeydown"] = onKeydown;
  exports["eventToKeyboardEvent"] = eventToKeyboardEvent;
  exports["respondToKey"] = respondToKey;
  exports["movePlayer"] = movePlayer;;
 
})(PS["Handlers.Keyboard"] = PS["Handlers.Keyboard"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Getter = PS["Optic.Getter"];
  var Optic_Setter = PS["Optic.Setter"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_ST = PS["Control.Monad.ST"];
  var Data_Array = PS["Data.Array"];
  var Data_Foldable = PS["Data.Foldable"];
  var Data_Int = PS["Data.Int"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Maybe_Unsafe = PS["Data.Maybe.Unsafe"];
  var $$Math = PS["Math"];
  var Optic_Core = PS["Optic.Core"];
  var Entities_Bullet = PS["Entities.Bullet"];
  var Entities_Enemies = PS["Entities.Enemies"];
  var Entities_Game = PS["Entities.Game"];
  var Entities_Invader = PS["Entities.Invader"];
  var Entities_MysteryShip = PS["Entities.MysteryShip"];
  var Entities_Star = PS["Entities.Star"];
  var Helpers_Lens = PS["Helpers.Lens"];
  var Data_Const = PS["Data.Const"];
  var Data_Identity = PS["Data.Identity"];     
  var moveStars = function (gRef) {
      return function __do() {
          var _37 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var stars = Optic_Getter["^."](_37)(Entities_Game.stars(Data_Const.functorConst));
              var newStars = Prelude.map(Prelude.functorArray)(function (s) {
                  return Optic_Setter["-~"](Prelude.ringNumber)(Entities_Star.y(Data_Identity.functorIdentity))(5.0)(s);
              })(stars);
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Optic_Setter[".~"](Entities_Game.stars(Data_Identity.functorIdentity))(newStars)(g_1);
              });
          })()();
      };
  };
  var movePlayerBullets = function (gRef) {
      return function __do() {
          var _38 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var playerBullets = Optic_Getter["^."](_38)(Entities_Game.playerBullets(Data_Const.functorConst));
              var newPlayerBullets = Prelude.map(Prelude.functorArray)(function (b) {
                  return Optic_Setter["-~"](Prelude.ringNumber)(Entities_Bullet.y(Data_Identity.functorIdentity))(20.0)(b);
              })(playerBullets);
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Optic_Setter[".~"](Entities_Game.playerBullets(Data_Identity.functorIdentity))(newPlayerBullets)(g_1);
              });
          })()();
      };
  };
  var moveMysteryShip = function (_124) {
      if (_124 instanceof Data_Maybe.Nothing) {
          return Data_Maybe.Nothing.value;
      };
      if (_124 instanceof Data_Maybe.Just) {
          return Data_Maybe.Just.create(Optic_Setter["+~"](Prelude.semiringNumber)(Entities_MysteryShip.x(Data_Identity.functorIdentity))(20.0)(_124.value0));
      };
      throw new Error("Failed pattern match at Handlers.Motion line 97, column 1 - line 99, column 1: " + [ _124.constructor.name ]);
  };
  var moveInvaderBullets = function (gRef) {
      return function __do() {
          var _39 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var invaderBullets = Optic_Getter["^."](_39)(Entities_Game.invaderBullets(Data_Const.functorConst));
              var newInvaderBullets = Prelude.map(Prelude.functorArray)(function (b) {
                  return Optic_Setter["+~"](Prelude.semiringNumber)(Entities_Bullet.y(Data_Identity.functorIdentity))(20.0)(b);
              })(invaderBullets);
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Optic_Setter[".~"](Entities_Game.invaderBullets(Data_Identity.functorIdentity))(newInvaderBullets)(g_1);
              });
          })()();
      };
  };
  var moveInvader = function (invader) {
      return function (newDx) {
          return function (newDy) {
              return Helpers_Lens["&"](Optic_Setter["+~"](Prelude.semiringNumber)(Entities_Invader.x(Data_Identity.functorIdentity))(newDx)(invader))(Optic_Setter["+~"](Prelude.semiringNumber)(Entities_Invader.y(Data_Identity.functorIdentity))(newDy));
          };
      };
  };
  var isPastMargins = function (minX) {
      return function (maxX) {
          return function (w) {
              return 50.0 > minX || w - 50.0 < maxX;
          };
      };
  };
  var computeDy = function (newDir) {
      return function (currDir) {
          if (Prelude["=="](Entities_Enemies.eqDirection)(newDir)(currDir)) {
              return 0.0;
          };
          if (Prelude.otherwise) {
              return 32.0;
          };
          throw new Error("Failed pattern match at Handlers.Motion line 84, column 1 - line 87, column 1: " + [ newDir.constructor.name, currDir.constructor.name ]);
      };
  };
  var computeDx = function (newDir) {
      return function (currDir) {
          return function (currDx) {
              return function (invaderCount) {
                  var sign = function (_127) {
                      if (_127 instanceof Entities_Enemies.Left) {
                          return -1;
                      };
                      if (_127 instanceof Entities_Enemies.Right) {
                          return 1;
                      };
                      throw new Error("Failed pattern match at Handlers.Motion line 81, column 5 - line 82, column 5: " + [ _127.constructor.name ]);
                  };
                  var ns = [ 1, 2, 3, 4, 6, 8, 12 ];
                  var idx = Data_Maybe_Unsafe.fromJust(Data_Array.findLastIndex(function (n) {
                      return n <= invaderCount;
                  })(ns));
                  return Data_Int.toNumber((24 / Data_Maybe_Unsafe.fromJust(Data_Array["!!"](ns)(idx)) | 0) * sign(newDir) | 0);
              };
          };
      };
  };
  var computeDirection = function (currDir) {
      return function (w) {
          return function (_123) {
              if (_123.length === 0) {
                  return currDir;
              };
              var go = function (_125) {
                  return function (_126) {
                      if (_125 instanceof Entities_Enemies.Left && _126) {
                          return Entities_Enemies.Right.value;
                      };
                      if (_125 instanceof Entities_Enemies.Right && _126) {
                          return Entities_Enemies.Left.value;
                      };
                      return _125;
                  };
              };
              var t = Data_Maybe_Unsafe.fromJust(Data_Array.tail(_123));
              var h = Data_Maybe_Unsafe.fromJust(Data_Array.head(_123));
              var maxX = Data_Foldable.foldl(Data_Foldable.foldableArray)(function (a) {
                  return function (i) {
                      return $$Math.max(a)(Optic_Getter["^."](i)(Entities_Invader.x(Data_Const.functorConst)));
                  };
              })(Optic_Getter["^."](h)(Entities_Invader.x(Data_Const.functorConst)))(t);
              var minX = Data_Foldable.foldl(Data_Foldable.foldableArray)(function (a) {
                  return function (i) {
                      return $$Math.min(a)(Optic_Getter["^."](i)(Entities_Invader.x(Data_Const.functorConst)));
                  };
              })(Optic_Getter["^."](h)(Entities_Invader.x(Data_Const.functorConst)))(t);
              var pastMargins = isPastMargins(minX)(maxX)(w);
              return go(currDir)(pastMargins);
          };
      };
  };
  var movePatrol = function (gRef) {
      return function __do() {
          var _40 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var w = Optic_Getter["^."](_40)(Entities_Game.w(Data_Const.functorConst));
              var currMysteryShip = Optic_Getter["^."](_40)(Entities_Game.mysteryShip(Data_Const.functorConst));
              var newMysteryShip = moveMysteryShip(currMysteryShip);
              var currInvaders = Optic_Getter["^."](_40)(Entities_Game.invaders(Data_Const.functorConst));
              var currDx = Optic_Getter["^."](_40)(Entities_Game.patrolDx(Data_Const.functorConst));
              var currDir = Optic_Getter["^."](_40)(Entities_Game.patrolDirection(Data_Const.functorConst));
              var newDir = computeDirection(currDir)(w)(currInvaders);
              var newDx = computeDx(newDir)(currDir)(currDx)(Data_Array.length(currInvaders));
              var newDy = computeDy(newDir)(currDir);
              var newInvaders = Prelude.map(Prelude.functorArray)(function (i) {
                  return moveInvader(i)(newDx)(newDy);
              })(currInvaders);
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Helpers_Lens["&"](Helpers_Lens["&"](Helpers_Lens["&"](Optic_Setter[".~"](Entities_Game.invaders(Data_Identity.functorIdentity))(newInvaders)(g_1))(Optic_Setter[".~"](Entities_Game.patrolDirection(Data_Identity.functorIdentity))(newDir)))(Optic_Setter[".~"](Entities_Game.patrolDx(Data_Identity.functorIdentity))(newDx)))(Optic_Setter[".~"](Entities_Game.mysteryShip(Data_Identity.functorIdentity))(newMysteryShip));
              });
          })()();
      };
  };
  var moveEverything = function (gRef) {
      return function __do() {
          Control_Monad_Eff.foreachE([ moveStars, movePlayerBullets, moveInvaderBullets, movePatrol ])(function (f) {
              return function __do() {
                  f(gRef)();
                  return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
              };
          })();
          return Control_Monad_ST.readSTRef(gRef)();
      };
  };
  exports["moveEverything"] = moveEverything;
  exports["movePatrol"] = movePatrol;
  exports["moveMysteryShip"] = moveMysteryShip;
  exports["moveInvader"] = moveInvader;
  exports["computeDy"] = computeDy;
  exports["computeDx"] = computeDx;
  exports["computeDirection"] = computeDirection;
  exports["isPastMargins"] = isPastMargins;
  exports["moveInvaderBullets"] = moveInvaderBullets;
  exports["movePlayerBullets"] = movePlayerBullets;
  exports["moveStars"] = moveStars;;
 
})(PS["Handlers.Motion"] = PS["Handlers.Motion"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Getter = PS["Optic.Getter"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_ST = PS["Control.Monad.ST"];
  var Data_Array = PS["Data.Array"];
  var Data_Date = PS["Data.Date"];
  var Data_Int = PS["Data.Int"];
  var Data_Maybe = PS["Data.Maybe"];
  var Data_Maybe_Unsafe = PS["Data.Maybe.Unsafe"];
  var Data_Time = PS["Data.Time"];
  var DOM_Timer = PS["DOM.Timer"];
  var Graphics_Canvas = PS["Graphics.Canvas"];
  var $$Math = PS["Math"];
  var Optic_Core = PS["Optic.Core"];
  var Entities_Bullet = PS["Entities.Bullet"];
  var Entities_Game = PS["Entities.Game"];
  var Entities_Invader = PS["Entities.Invader"];
  var Entities_MysteryShip = PS["Entities.MysteryShip"];
  var Entities_Star = PS["Entities.Star"];
  var Helpers_Image = PS["Helpers.Image"];
  var Data_Const = PS["Data.Const"];     
  var renderStars = function (ctx) {
      return function (g) {
          return function __do() {
              Graphics_Canvas.setFillStyle("#FFFFFF")(ctx)();
              return Control_Monad_Eff.foreachE(Optic_Getter["^."](g)(Entities_Game.stars(Data_Const.functorConst)))(function (s) {
                  return function __do() {
                      Graphics_Canvas.fillRect(ctx)({
                          x: Optic_Getter["^."](s)(Entities_Star.x(Data_Const.functorConst)), 
                          y: Optic_Getter["^."](s)(Entities_Star.y(Data_Const.functorConst)), 
                          w: 4.0, 
                          h: 4.0
                      })();
                      return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                  };
              })();
          };
      };
  };
  var renderScore = function (ctx) {
      return function (g) {
          return function __do() {
              Graphics_Canvas.setFillStyle("#7700FF")(ctx)();
              Graphics_Canvas.setFont("32pt Courier")(ctx)();
              Graphics_Canvas.fillText(ctx)(Prelude.show(Prelude.showInt)(Optic_Getter["^."](g)(Entities_Game.score(Data_Const.functorConst))))(50.0)(40.0)();
              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
          };
      };
  };
  var renderPlayerBullets = function (ctx) {
      return function (g) {
          return function __do() {
              Control_Monad_Eff.foreachE(Optic_Getter["^."](g)(Entities_Game.playerBullets(Data_Const.functorConst)))(function (b) {
                  return function __do() {
                      Helpers_Image.drawImageCentered(ctx)(Optic_Getter["^."](g)(Entities_Game.playerBulletSprite(Data_Const.functorConst)))(Optic_Getter["^."](b)(Entities_Bullet.x(Data_Const.functorConst)))(Optic_Getter["^."](b)(Entities_Bullet.y(Data_Const.functorConst)))();
                      return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                  };
              })();
              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
          };
      };
  };
  var renderPlayer = function (ctx) {
      return function (g) {
          return function __do() {
              Helpers_Image.drawImageCentered(ctx)(Optic_Getter["^."](g)(Entities_Game.playerSprite(Data_Const.functorConst)))(Optic_Getter["^."](g)(Entities_Game.playerX(Data_Const.functorConst)))(Optic_Getter["^."](g)(Entities_Game.playerY(Data_Const.functorConst)))();
              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
          };
      };
  };
  var renderLives = function (ctx) {
      return function (g) {
          var lives = Optic_Getter["^."](g)(Entities_Game.lives(Data_Const.functorConst));
          return function __do() {
              Control_Monad_Eff.forE(0.0)(Data_Int.toNumber(lives))(function (i) {
                  return function __do() {
                      Helpers_Image.drawImageCentered(ctx)(Optic_Getter["^."](g)(Entities_Game.lifeSprite(Data_Const.functorConst)))(Optic_Getter["^."](g)(Entities_Game.w(Data_Const.functorConst)) - i * 32.0 - 50.0)(30.0)();
                      return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                  };
              })();
              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
          };
      };
  };
  var renderEnemyBullets = function (ctx) {
      return function (g) {
          var chooseSprite = function (_132) {
              if (_132 instanceof Entities_Bullet.Invader) {
                  return Optic_Getter["^."](g)(Entities_Game.invaderBulletSprite(Data_Const.functorConst));
              };
              if (_132 instanceof Entities_Bullet.Mystery) {
                  return Optic_Getter["^."](g)(Entities_Game.mysteryBulletSprite(Data_Const.functorConst));
              };
              throw new Error("Failed pattern match at Handlers.Rendering line 165, column 5 - line 166, column 5: " + [ _132.constructor.name ]);
          };
          return function __do() {
              Control_Monad_Eff.foreachE(Optic_Getter["^."](g)(Entities_Game.invaderBullets(Data_Const.functorConst)))(function (b) {
                  return function __do() {
                      Helpers_Image.drawImageCentered(ctx)(chooseSprite(Optic_Getter["^."](b)(Entities_Bullet.bulletType(Data_Const.functorConst))))(Optic_Getter["^."](b)(Entities_Bullet.x(Data_Const.functorConst)))(Optic_Getter["^."](b)(Entities_Bullet.y(Data_Const.functorConst)))();
                      return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                  };
              })();
              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
          };
      };
  };
  var possiblyRenderMysteryShip = function (ctx) {
      return function (g) {
          return function __do() {
              var _41 = Data_Date.nowEpochMilliseconds();
              return (function () {
                  var chooseSprite = function (_129) {
                      return Data_Maybe_Unsafe.fromJust(Data_Int.fromNumber($$Math.floor(_129 * 4.0))) % 4;
                  };
                  var go = function (_130) {
                      if (_130 instanceof Data_Maybe.Nothing) {
                          return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit);
                      };
                      if (_130 instanceof Data_Maybe.Just) {
                          var secondsIntoGame = Data_Time.toSeconds(Data_Time.timeValueMilliseconds)(Prelude["-"](Data_Time.ringMilliseconds)(_41)(Optic_Getter["^."](g)(Entities_Game.startTime(Data_Const.functorConst))));
                          var mysteryShipSprites = Optic_Getter["^."](g)(Entities_Game.mysteryShipSprites(Data_Const.functorConst));
                          var mysteryShipSprite = Data_Maybe_Unsafe.fromJust(Data_Array["!!"](mysteryShipSprites)(chooseSprite(secondsIntoGame)));
                          return function __do() {
                              Helpers_Image.drawImageCentered(ctx)(mysteryShipSprite)(Optic_Getter["^."](_130.value0)(Entities_MysteryShip.x(Data_Const.functorConst)))(Optic_Getter["^."](_130.value0)(Entities_MysteryShip.y(Data_Const.functorConst)))();
                              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                          };
                      };
                      throw new Error("Failed pattern match at Handlers.Rendering line 75, column 1 - line 80, column 1: " + [ _130.constructor.name ]);
                  };
                  return go(Optic_Getter["^."](g)(Entities_Game.mysteryShip(Data_Const.functorConst)));
              })()();
          };
      };
  };
  var renderEnemies = function (ctx) {
      return function (g) {
          return function __do() {
              var _42 = Data_Date.nowEpochMilliseconds();
              return (function () {
                  var shotInvaderSprite = Optic_Getter["^."](g)(Entities_Game.shotInvaderSprite(Data_Const.functorConst));
                  var secondsIntoGame = Data_Time.toSeconds(Data_Time.timeValueMilliseconds)(Prelude["-"](Data_Time.ringMilliseconds)(_42)(Optic_Getter["^."](g)(Entities_Game.startTime(Data_Const.functorConst))));
                  var invaders = Optic_Getter["^."](g)(Entities_Game.invaders(Data_Const.functorConst));
                  var invaderSprites = Optic_Getter["^."](g)(Entities_Game.invaderSprites(Data_Const.functorConst));
                  var deadInvaderSprite = Optic_Getter["^."](g)(Entities_Game.deadInvaderSprite(Data_Const.functorConst));
                  var chooseSprite = function (status) {
                      return function (_131) {
                          return function (idx) {
                              if (status instanceof Entities_Invader.Alive) {
                                  var idx$prime = Data_Int.toNumber(idx);
                                  var spriteIdx = Data_Maybe_Unsafe.fromJust(Data_Int.fromNumber($$Math.floor(idx$prime + _131 * 2.0))) % 2;
                                  return Data_Maybe_Unsafe.fromJust(Data_Array["!!"](invaderSprites)(spriteIdx));
                              };
                              if (status instanceof Entities_Invader.Shot) {
                                  return shotInvaderSprite;
                              };
                              if (status instanceof Entities_Invader.Dead) {
                                  return deadInvaderSprite;
                              };
                              throw new Error("Failed pattern match at Handlers.Rendering line 98, column 1 - line 103, column 1: " + [ status.constructor.name ]);
                          };
                      };
                  };
                  return function __do() {
                      Control_Monad_Eff.foreachE(invaders)(function (i) {
                          var sprite = chooseSprite(Optic_Getter["^."](i)(Entities_Invader.status(Data_Const.functorConst)))(secondsIntoGame)(Optic_Getter["^."](i)(Entities_Invader.idx(Data_Const.functorConst)));
                          return function __do() {
                              Helpers_Image.drawImageCentered(ctx)(sprite)(Optic_Getter["^."](i)(Entities_Invader.x(Data_Const.functorConst)))(Optic_Getter["^."](i)(Entities_Invader.y(Data_Const.functorConst)))();
                              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                          };
                      })();
                      return possiblyRenderMysteryShip(ctx)(g)();
                  };
              })()();
          };
      };
  };
  var render$prime = function (_128) {
      return function (gRef) {
          if (_128 instanceof Entities_Game.Playing) {
              return function __do() {
                  var _45 = Graphics_Canvas.getCanvasElementById("canvas")();
                  if (_45 instanceof Data_Maybe.Just) {
                      var _44 = Graphics_Canvas.getContext2D(_45.value0)();
                      var _43 = Control_Monad_ST.readSTRef(gRef)();
                      Graphics_Canvas.setFillStyle("#000000")(_44)();
                      Graphics_Canvas.fillRect(_44)({
                          x: 0.0, 
                          y: 0.0, 
                          w: Optic_Getter["^."](_43)(Entities_Game.w(Data_Const.functorConst)), 
                          h: Optic_Getter["^."](_43)(Entities_Game.h(Data_Const.functorConst))
                      })();
                      return Control_Monad_Eff.foreachE([ renderStars, renderScore, renderLives, renderEnemies, renderPlayer, renderPlayerBullets, renderEnemyBullets ])(function (f) {
                          return f(_44)(_43);
                      })();
                  };
                  throw new Error("Failed pattern match at Handlers.Rendering line 168, column 1 - line 173, column 1: " + [ _45.constructor.name ]);
              };
          };
          if (_128 instanceof Entities_Game.Waiting) {
              return function __do() {
                  var _48 = Graphics_Canvas.getCanvasElementById("canvas")();
                  if (_48 instanceof Data_Maybe.Just) {
                      var _47 = Graphics_Canvas.getContext2D(_48.value0)();
                      var _46 = Control_Monad_ST.readSTRef(gRef)();
                      Graphics_Canvas.setFillStyle("#000000")(_47)();
                      Graphics_Canvas.fillRect(_47)({
                          x: 0.0, 
                          y: 0.0, 
                          w: Optic_Getter["^."](_46)(Entities_Game.w(Data_Const.functorConst)), 
                          h: Optic_Getter["^."](_46)(Entities_Game.h(Data_Const.functorConst))
                      })();
                      Graphics_Canvas.setFont("40pt Courier")(_47)();
                      var allText = [ {
                          color: "#FFFFFF", 
                          text: "main =", 
                          x: 50.0, 
                          y: 200.0
                      }, {
                          color: "#FF00FF", 
                          text: "do", 
                          x: 275.0, 
                          y: 200.0
                      }, {
                          color: "#FFFFFF", 
                          text: "spaceInvaders `in`", 
                          x: 100.0, 
                          y: 250.0
                      }, {
                          color: "#FFFFFF", 
                          text: "pureScript", 
                          x: 150.0, 
                          y: 300.0
                      }, {
                          color: "#FFFFFF", 
                          text: "respondTo", 
                          x: 50.0, 
                          y: 400.0
                      }, {
                          color: "#CC0000", 
                          text: "S", 
                          x: 375.0, 
                          y: 400.0
                      }, {
                          color: "#FFFFFF", 
                          text: "= startGame", 
                          x: 435.0, 
                          y: 400.0
                      }, {
                          color: "#FFFFFF", 
                          text: "respondTo _ =", 
                          x: 50.0, 
                          y: 450.0
                      }, {
                          color: "#FFFFFF", 
                          text: "stareAtThisScreen", 
                          x: 100.0, 
                          y: 500.0
                      } ];
                      Control_Monad_Eff.foreachE(allText)(function (t) {
                          return function __do() {
                              Graphics_Canvas.setFillStyle(t.color)(_47)();
                              Graphics_Canvas.fillText(_47)(t.text)(t.x)(t.y)();
                              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                          };
                      })();
                      return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                  };
                  throw new Error("Failed pattern match at Handlers.Rendering line 168, column 1 - line 173, column 1: " + [ _48.constructor.name ]);
              };
          };
          if (_128 instanceof Entities_Game.GameOver) {
              return function __do() {
                  var _51 = Graphics_Canvas.getCanvasElementById("canvas")();
                  if (_51 instanceof Data_Maybe.Just) {
                      var _50 = Graphics_Canvas.getContext2D(_51.value0)();
                      var _49 = Control_Monad_ST.readSTRef(gRef)();
                      Graphics_Canvas.setFillStyle("#000000")(_50)();
                      Graphics_Canvas.fillRect(_50)({
                          x: 0.0, 
                          y: 0.0, 
                          w: Optic_Getter["^."](_49)(Entities_Game.w(Data_Const.functorConst)), 
                          h: Optic_Getter["^."](_49)(Entities_Game.h(Data_Const.functorConst))
                      })();
                      Graphics_Canvas.setFont("40pt Courier")(_50)();
                      var allText = [ {
                          color: "#FFFFFF", 
                          text: "{ status:", 
                          x: 50.0, 
                          y: 350.0
                      }, {
                          color: "#CC0000", 
                          text: "GameOver", 
                          x: 375.0, 
                          y: 350.0
                      }, {
                          color: "#FFFFFF", 
                          text: "}", 
                          x: 650.0, 
                          y: 350.0
                      } ];
                      Control_Monad_Eff.foreachE(allText)(function (t) {
                          return function __do() {
                              Graphics_Canvas.setFillStyle(t.color)(_50)();
                              Graphics_Canvas.fillText(_50)(t.text)(t.x)(t.y)();
                              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                          };
                      })();
                      return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                  };
                  throw new Error("Failed pattern match at Handlers.Rendering line 168, column 1 - line 173, column 1: " + [ _51.constructor.name ]);
              };
          };
          throw new Error("Failed pattern match at Handlers.Rendering line 168, column 1 - line 173, column 1: " + [ _128.constructor.name, gRef.constructor.name ]);
      };
  };
  var render = function (gRef) {
      return function __do() {
          var _52 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var gameStatus = Optic_Getter["^."](_52)(Entities_Game.status(Data_Const.functorConst));
              return render$prime(gameStatus)(gRef);
          })()();
      };
  };
  exports["render"] = render;
  exports["renderEnemyBullets"] = renderEnemyBullets;
  exports["renderPlayerBullets"] = renderPlayerBullets;
  exports["renderPlayer"] = renderPlayer;
  exports["renderEnemies"] = renderEnemies;
  exports["possiblyRenderMysteryShip"] = possiblyRenderMysteryShip;
  exports["renderLives"] = renderLives;
  exports["renderScore"] = renderScore;
  exports["renderStars"] = renderStars;;
 
})(PS["Handlers.Rendering"] = PS["Handlers.Rendering"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Optic_Getter = PS["Optic.Getter"];
  var Optic_Setter = PS["Optic.Setter"];
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_Eff_Random = PS["Control.Monad.Eff.Random"];
  var Control_Monad_ST = PS["Control.Monad.ST"];
  var Data_Array = PS["Data.Array"];
  var Data_Date = PS["Data.Date"];
  var Data_Maybe = PS["Data.Maybe"];
  var Optic_Core = PS["Optic.Core"];
  var Entities_Bullet = PS["Entities.Bullet"];
  var Entities_Enemies = PS["Entities.Enemies"];
  var Entities_Event = PS["Entities.Event"];
  var Entities_Game = PS["Entities.Game"];
  var Entities_Invader = PS["Entities.Invader"];
  var Entities_Star = PS["Entities.Star"];
  var Entities_MysteryShip = PS["Entities.MysteryShip"];
  var Handlers_Collision = PS["Handlers.Collision"];
  var Handlers_Generation = PS["Handlers.Generation"];
  var Handlers_Motion = PS["Handlers.Motion"];
  var Helpers_Lens = PS["Helpers.Lens"];
  var Data_Const = PS["Data.Const"];
  var Data_Identity = PS["Data.Identity"];
  var Data_Profunctor = PS["Data.Profunctor"];     
  var updateMysteryShipStatus = function (gRef) {
      return function __do() {
          var _54 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var newMysteryShip = function (_134) {
                  if (_134 instanceof Data_Maybe.Just) {
                      var _393 = Optic_Getter["^."](_134.value0)(Entities_MysteryShip.status(Data_Const.functorConst));
                      if (_393 instanceof Entities_MysteryShip.Shot) {
                          return Data_Maybe.Just.create(Optic_Setter[".~"](Entities_MysteryShip.status(Data_Identity.functorIdentity))(Entities_MysteryShip.Dead.value)(_134.value0));
                      };
                      if (_393 instanceof Entities_MysteryShip.Dead) {
                          return Data_Maybe.Nothing.value;
                      };
                      return new Data_Maybe.Just(_134.value0);
                  };
                  return Data_Maybe.Nothing.value;
              };
              var mysteryShip = Optic_Getter["^."](_54)(Entities_Game.mysteryShip(Data_Const.functorConst));
              var go = function (_135) {
                  if (_135 instanceof Data_Maybe.Just) {
                      return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                          return Optic_Setter[".~"](Entities_Game.mysteryShip(Data_Identity.functorIdentity))(newMysteryShip(mysteryShip))(g_1);
                      });
                  };
                  return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                      return g_1;
                  });
              };
              return go(mysteryShip);
          })()();
      };
  };
  var updateInvaderStatus = function (gRef) {
      return function __do() {
          var _53 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var newStatus = function (status) {
                  if (status instanceof Entities_Invader.Shot) {
                      return Entities_Invader.Dead.value;
                  };
                  return status;
              };
              var invaders = Optic_Getter["^."](_53)(Entities_Game.invaders(Data_Const.functorConst));
              var remainingInvaders = Data_Array.filter(function (i) {
                  return Prelude["/="](Entities_Invader.eqStatus)(Optic_Getter["^."](i)(Entities_Invader.status(Data_Const.functorConst)))(Entities_Invader.Dead.value);
              })(invaders);
              var newInvaders = Prelude.map(Prelude.functorArray)(function (i) {
                  return Optic_Setter[".~"](Entities_Invader.status(Data_Identity.functorIdentity))(newStatus(Optic_Getter["^."](i)(Entities_Invader.status(Data_Const.functorConst))))(i);
              })(remainingInvaders);
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Optic_Setter[".~"](Entities_Game.invaders(Data_Identity.functorIdentity))(newInvaders)(g_1);
              });
          })()();
      };
  };
  var removeOffscreenObjects = function (gRef) {
      return function __do() {
          var _56 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var stars = Optic_Getter["^."](_56)(Entities_Game.stars(Data_Const.functorConst));
              var playerBullets = Optic_Getter["^."](_56)(Entities_Game.playerBullets(Data_Const.functorConst));
              var newStars = Data_Array.filter(function (s) {
                  return Optic_Getter["^."](s)(Entities_Star.y(Data_Const.functorConst)) > -10.0;
              })(stars);
              var newPlayerBullets = Data_Array.filter(function (b) {
                  return Optic_Getter["^."](b)(Entities_Bullet.y(Data_Const.functorConst)) > -10.0;
              })(playerBullets);
              var invaderBullets = Optic_Getter["^."](_56)(Entities_Game.invaderBullets(Data_Const.functorConst));
              var newInvaderBullets = Data_Array.filter(function (b) {
                  return Optic_Getter["^."](b)(Entities_Bullet.y(Data_Const.functorConst)) < Optic_Getter["^."](_56)(Entities_Game.h(Data_Const.functorConst)) + 10.0;
              })(invaderBullets);
              return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                  return Helpers_Lens["&"](Helpers_Lens["&"](Optic_Setter[".~"](Entities_Game.playerBullets(Data_Identity.functorIdentity))(newPlayerBullets)(g_1))(Optic_Setter[".~"](Entities_Game.invaderBullets(Data_Identity.functorIdentity))(newInvaderBullets)))(Optic_Setter[".~"](Entities_Game.stars(Data_Identity.functorIdentity))(newStars));
              });
          })()();
      };
  };
  var possiblyRemoveOffscreenMysteryShip = function (gRef) {
      return function __do() {
          var _55 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var go = function (_136) {
                  if (_136 instanceof Data_Maybe.Just) {
                      if (Optic_Getter["^."](_136.value0)(Entities_MysteryShip.x(Data_Const.functorConst)) > Optic_Getter["^."](_55)(Entities_Game.w(Data_Const.functorConst)) + 100.0) {
                          return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                              return Helpers_Lens["&"](Optic_Setter[".~"](Entities_Game.mysteryShip(Data_Identity.functorIdentity))(Data_Maybe.Nothing.value)(g_1))(Optic_Setter["%~"](Data_Profunctor.profunctorFn)(Entities_Game.events(Data_Identity.functorIdentity))(Data_Array.cons(new Entities_Event.Event(Entities_Event.GoneMysteryShip.value, Entities_Event.New.value))));
                          });
                      };
                      if (Prelude.otherwise) {
                          return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                              return g_1;
                          });
                      };
                  };
                  return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                      return g_1;
                  });
              };
              var currMysteryShip = Optic_Getter["^."](_55)(Entities_Game.mysteryShip(Data_Const.functorConst));
              return go(currMysteryShip);
          })()();
      };
  };
  var checkPlayerDead = function (gRef) {
      return function __do() {
          var _57 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var lives = Optic_Getter["^."](_57)(Entities_Game.lives(Data_Const.functorConst));
              var go = function (lives_1) {
                  if (lives_1 === 0) {
                      return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                          return Optic_Setter[".~"](Entities_Game.status(Data_Identity.functorIdentity))(Entities_Game.GameOver.value)(g_1);
                      });
                  };
                  if (Prelude.otherwise) {
                      return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                          return g_1;
                      });
                  };
                  throw new Error("Failed pattern match at Update line 92, column 1 - line 94, column 1: " + [ lives_1.constructor.name ]);
              };
              return go(lives);
          })()();
      };
  };
  var checkInvadersCleared = function (gRef) {
      return function __do() {
          var _58 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var invaders = Optic_Getter["^."](_58)(Entities_Game.invaders(Data_Const.functorConst));
              var go = function (_137) {
                  if (_137 === 0) {
                      return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                          return Optic_Setter[".~"](Entities_Game.enemies(Data_Identity.functorIdentity))(Entities_Enemies.makeRegularLevel)(g_1);
                      });
                  };
                  return Control_Monad_ST.modifySTRef(gRef)(function (g_1) {
                      return g_1;
                  });
              };
              return go(Data_Array.length(invaders));
          })()();
      };
  };
  var update$prime = function (_133) {
      return function (gRef) {
          if (_133 instanceof Entities_Game.Playing) {
              return function __do() {
                  Control_Monad_Eff.foreachE([ checkPlayerDead, Handlers_Collision.checkPlayerShot, Handlers_Collision.checkInvadersShot, Handlers_Collision.checkMysteryShipShot, checkInvadersCleared, Handlers_Motion.moveEverything, updateInvaderStatus, updateMysteryShipStatus, Handlers_Generation.generateEverything, removeOffscreenObjects, possiblyRemoveOffscreenMysteryShip ])(function (f) {
                      return function __do() {
                          f(gRef)();
                          return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
                      };
                  })();
                  return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit)();
              };
          };
          if (_133 instanceof Entities_Game.Waiting) {
              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit);
          };
          if (_133 instanceof Entities_Game.GameOver) {
              return Prelude["return"](Control_Monad_Eff.applicativeEff)(Prelude.unit);
          };
          throw new Error("Failed pattern match at Update line 112, column 1 - line 129, column 1: " + [ _133.constructor.name, gRef.constructor.name ]);
      };
  };
  var update = function (gRef) {
      return function __do() {
          var _59 = Control_Monad_ST.readSTRef(gRef)();
          return (function () {
              var gameStatus = Optic_Getter["^."](_59)(Entities_Game.status(Data_Const.functorConst));
              return update$prime(gameStatus)(gRef);
          })()();
      };
  };
  exports["update"] = update;
  exports["checkInvadersCleared"] = checkInvadersCleared;
  exports["checkPlayerDead"] = checkPlayerDead;
  exports["removeOffscreenObjects"] = removeOffscreenObjects;
  exports["possiblyRemoveOffscreenMysteryShip"] = possiblyRemoveOffscreenMysteryShip;
  exports["updateMysteryShipStatus"] = updateMysteryShipStatus;
  exports["updateInvaderStatus"] = updateInvaderStatus;;
 
})(PS["Update"] = PS["Update"] || {});
(function(exports) {
  // Generated by psc version 0.7.4.1
  "use strict";
  var Prelude = PS["Prelude"];
  var Control_Monad_Eff = PS["Control.Monad.Eff"];
  var Control_Monad_Eff_Random = PS["Control.Monad.Eff.Random"];
  var Control_Monad_ST = PS["Control.Monad.ST"];
  var Data_Date = PS["Data.Date"];
  var DOM = PS["DOM"];
  var DOM_Event_EventTarget = PS["DOM.Event.EventTarget"];
  var DOM_Event_Types = PS["DOM.Event.Types"];
  var DOM_HTML = PS["DOM.HTML"];
  var DOM_HTML_Types = PS["DOM.HTML.Types"];
  var DOM_Node_NonElementParentNode = PS["DOM.Node.NonElementParentNode"];
  var DOM_Node_Types = PS["DOM.Node.Types"];
  var DOM_Timer = PS["DOM.Timer"];
  var Graphics_Canvas = PS["Graphics.Canvas"];
  var Optic_Core = PS["Optic.Core"];
  var Entities_Game = PS["Entities.Game"];
  var Handlers_Event = PS["Handlers.Event"];
  var Handlers_Keyboard = PS["Handlers.Keyboard"];
  var Handlers_Rendering = PS["Handlers.Rendering"];
  var Update = PS["Update"];     
  var gameLoop = function (gRef) {
      return DOM_Timer.timeout(50)(function __do() {
          Handlers_Rendering.render(gRef)();
          Handlers_Event.processEvents(gRef)();
          Handlers_Event.clearHandledEvents(gRef)();
          return gameLoop(gRef)();
      });
  };
  var main = function __do() {
      var _62 = Entities_Game.makeGame(800.0)(750.0)();
      var _61 = Control_Monad_ST.newSTRef(_62)();
      var _60 = DOM_HTML.window();
      DOM_Event_EventTarget.addEventListener("keydown")(Handlers_Keyboard.onKeydown(_61))(false)(DOM_HTML_Types.windowToEventTarget(_60))();
      DOM_Timer.interval(50)(Update.update(_61))();
      return gameLoop(_61)();
  };
  exports["main"] = main;
  exports["gameLoop"] = gameLoop;;
 
})(PS["Main"] = PS["Main"] || {});

PS["Main"].main();
